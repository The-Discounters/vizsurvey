(this.webpackJsonpvizsurvey=this.webpackJsonpvizsurvey||[]).push([[0],{120:function(t){t.exports=JSON.parse('{"a":"1.0.1"}')},234:function(t,e){},235:function(t,e,n){},236:function(t,e,n){},247:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(34),c=n.n(i),s=n(10),o=n(50),u=n(1),l=n.n(u),d=n(4),b=n(17),m=n(26),j=n(27),h=n(14),p=n(123),f=n(88),_=n(111),x=atob("Z2hwX2RsSG54M3JkNHB2Z0puQmp2OUdiYzJVdkFzNDRzbTBJMlVGTQo="),g="d2d5617ce3c6b4436ec781854ba10341",v="Unitialized",O="Earlier",y="Later",w="Unitialized",q="Fetching",S="Fetched",k="Complete",Q="Error",A=function(t){Object(m.a)(n,t);var e=Object(j.a)(n);function n(){return Object(b.a)(this,n),e.apply(this,arguments)}return n}(_.Enumify);A.word=new A,A.barchart=new A,A.calendar=new A,A._=A.closeEnum();var z=Object(o.b)("survey/getQuestions",function(){var t=Object(d.a)(l.a.mark((function t(e){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=+e,t.next=3,Object(h.c)("https://gist.githubusercontent.com/pcordone/f8095509f669e2a3ac98bbfa586d16d9/raw/");case 3:return(n=t.sent).forEach((function(t){t.view_type=A.enumValueOf(t.view_type),t.question_set_id=+t.question_set_id,t.position=+t.position,t.amount_earlier=+t.amount_earlier,t.time_earlier&&(t.time_earlier=+t.time_earlier),t.date_earlier&&(t.date_earlier=new Date(t.date_earlier)),t.amount_later=+t.amount_later,t.time_later&&(t.time_later=+t.time_later),t.date_later&&(t.date_later=new Date(t.date_later)),t.max_amount=+t.max_amount,t.max_time=+t.max_time,t.horizontal_pixels=+t.horizontal_pixels,t.vertical_pixels=+t.vertical_pixels,t.choice=v,t.answer_time=void 0,t.participant_id=void 0})),a=n.filter((function(t){return t.question_set_id===e})),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),D=Object(o.b)("survey/writeAnswers",function(){var t=Object(d.a)(l.a.mark((function t(e,n){var a,r,i,c,s,o,u,d,b,m;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.getState,r=a(),i=new p.a({userAgent:"thesis_answers/v1.0",auth:x}),c="PATCH /gists/".concat(g),s=f.DateTime.now().toFormat("yyyy-MM-dd-H-mm-ss-SSS-ZZZZ"),o={},e="".concat(e),o["answers-subject-".concat(r.questions.participant_id,"-").concat(s,".csv")]={content:e},u="Answer results for participant ".concat(r.questions.participant_id," at ").concat(s),console.log("submitting answers for "+u),d={gist_id:g,description:u,files:o},t.next=13,i.request(c,d);case 13:b=t.sent,m=b.status,console.log("answers submitted with status of "+m);case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),F=Object(o.c)({name:"questions",initialState:{questions:[],currentQuestion:0,question_set_id:null,participant_id:null,status:"Unitialized",error:null},reducers:{setParticipant:function(t,e){null===t.participant_id&&null!==e.payload&&(t.participant_id=e.payload)},setQuestionSet:function(t,e){null===t.questionSetId&&null!==e.payload&&(t.question_set_id=e.payload)},answer:function(t,e){t.questions[t.currentQuestion].choice=e.payload,t.questions[t.currentQuestion].answer_time=f.DateTime.now().toFormat("MM/dd/yyyy H:mm:ss:SSS ZZZZ"),t.questions[t.currentQuestion].participant_id=t.participant_id,t.currentQuestion===t.questions.length-1?t.status=k:t.currentQuestion+=1},nextQuestion:function(t){t.questions.currentQuestion+=t.currentQuestion<t.questions.length?1:0},previousQuestion:function(t){t.currentQuestion-=t.currentQuestion>0?1:0}},extraReducers:function(t){t.addCase(z.pending,(function(t){t.status===w&&(t.status=q)})).addCase(z.fulfilled,(function(t,e){t.questions=e.payload,t.currentQuestion=0,t.status=S})).addCase(z.rejected,(function(t,e){t.status===S&&(t.status=Q,t.error=e.error)}))}}),M=function(t){return t.questions.questions},I=function(t){return t.questions.questions[t.questions.currentQuestion]},T=function(t){return t.questions.status},E=F.actions,N=E.answer,R=(E.nextQuestion,E.previousQuestion,E.setParticipant),Z=E.setQuestionSet,C=F.reducer,J=Object(o.a)({reducer:{questions:C}}),B=(n(235),n(40)),L=n(11),P=n(255),V=n(256),U=(n(236),n(252)),H=n(253),G=n(254),$=n(51),W=n(251),Y=n(2);var X=function(){var t=Object(s.b)(),e=Object(s.c)(I),n=Object(s.c)(T);function a(){return"$".concat(e.amount_earlier," ").concat(0===(t=e.time_earlier)?"today":"in ".concat(t," weeks"));var t}var r=Object(Y.jsx)($.d,{initialValues:{choice:v},validate:function(t){var e={};return t.choice&&t.choice!==v||(e.choice="Please choose a selection to continue."),e},onSubmit:function(e,n){var a=n.setSubmitting,r=n.resetForm;setTimeout((function(){t(N(e.choice)),a(!1),r()}),400)},children:function(t){var n=t.isSubmitting;return Object(Y.jsxs)($.c,{children:[Object(Y.jsxs)("div",{role:"group","aria-labelledby":"my-radio-group",className:"radio-choice-label",children:[Object(Y.jsxs)("label",{children:[Object(Y.jsx)($.b,{type:"radio",name:"choice",value:O}),"\xa0",a()]}),Object(Y.jsx)("br",{}),Object(Y.jsxs)("label",{children:[Object(Y.jsx)($.b,{type:"radio",name:"choice",value:y}),"\xa0","$".concat(e.amount_later," in ").concat(e.time_later," weeks")]}),Object(Y.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:Object(Y.jsx)($.a,{name:"choice",component:"div"})})]}),Object(Y.jsx)(W.a,{type:"submit",disabled:n,children:"Submit"})]})}});return n===k?Object(Y.jsx)(L.a,{to:"/thankyou"}):r},K=function(t,e){var n=r.a.useRef();return r.a.useEffect((function(){return t(h.h(n.current)),function(){}}),e),n};var tt=function(t){var e=Object(s.b)(),n=Object(s.c)(I),a=Object(s.c)(T),r=n.vertical_pixels,i=n.horizontal_pixels,c={top:t.top_margin,right:t.right_margin,bottom:t.bottom_margin,left:t.left_margin},o={height:r+parseInt(c.top)+parseInt(c.bottom),width:i+parseInt(c.left)+parseInt(c.right),marginLeft:c.left+"px",marginRight:c.right+"px"},u=Array.from(Array(n.max_time+1).keys()),l=u.map((function(t){return t==n.time_earlier?{time:t,amount:n.amount_earlier}:t==n.time_later?{time:t,amount:n.amount_later}:{time:t,amount:0}})),d=Object(Y.jsx)("svg",{ref:K((function(t){var a=t.selectAll(".plot-area").data([null]).join("g").attr("class","plot-area").attr("transform","translate(".concat(c.left,",").concat(c.top,")")),s=Object(h.g)().domain([0,n.max_time]).range([0,i]),o=[0,n.max_amount],d=Object(h.g)().domain(o).range([r,0]);a.selectAll(".x-axis").data([null]).join("g").attr("transform","translate(0,".concat(r,")")).attr("class","x-axis").call(Object(h.a)(s).tickValues(u).tickFormat(h.d(",.0f")));var b=Object(h.f)(o[0],o[1],o[1]/5);b.push(o[1]),a.selectAll(".y-axis").data([null]).join("g").attr("class","y-axis").call(Object(h.b)(d).tickValues(b).tickFormat(h.d("$,.0f"))),a.selectAll(".bar").data(l).join("rect").attr("fill","steelblue").attr("class","bar").attr("x",(function(t){return s(t.time)-7.5})).attr("width",15).attr("y",(function(t){return d(t.amount)})).on("click",(function(t){t.target.__data__.amount===n.amount_earlier?e(N(O)):e(N(y))})).attr("height",(function(t){return d(0)-d(t.amount)}))}),[l]),style:o});return a===k?Object(Y.jsx)(L.a,{to:"/thankyou"}):d},et=n(241);var nt=function(t){var e=Object(s.c)(I),n=e.vertical_pixels,a=e.horizontal_pixels,r={top:t.top_margin,right:t.right_margin,bottom:t.bottom_margin,left:t.left_margin},i={height:n+parseInt(r.top)+parseInt(r.bottom),width:a+parseInt(r.left)+parseInt(r.right),marginLeft:r.left+"px",marginRight:r.right+"px"};return Object(Y.jsx)("table",{id:"calendar",ref:K((function(t){var n=et(e.date_earlier),a=["January","February","March","April","May","June","July","August","September","October","November","December"][e.date_earlier.getMonth()];t.html("<thead>\n                <tr>\n                    <td span='7'>\n                        <h2 id='currentMonth'></h2>\n                    </td>\n                </tr>\n                <tr>\n                    <td style='text-align: center;'>Sunday</td>\n                    <td style='text-align: center;'>Monday</td>\n                    <td style='text-align: center;'>Tuesday</td>\n                    <td style='text-align: center;'>Wednesday</td>\n                    <td style='text-align: center;'>Thursday</td>\n                    <td style='text-align: center;'>Friday</td>\n                    <td style='text-align: center;'>Saturday</td>\n                </tr>\n            </thead>\n            <tbody id='calendarBody'></tbody>");var r=h.h("#calendar");r.select("#currentMonth").data([a]).join("h2").text((function(t){return t}));var i=r.select("#calendarBody").selectAll("tbody").data(n).join("tr"),c=e.date_earlier.getDate(),s=e.date_later.getDate();i.selectAll("td").data((function(t){return t})).join("td").attr("class",(function(t){return t>0?"calendarDay":"calendarDayEmpty"})).attr("id",(function(t){return"calendarDay-"+t})).html((function(t){return t===c||t===s?"<div>".concat(t,"</div><svg id='").concat(t===c?"earlierAmount":"laterAmount","'></svg>"):t>0?t:""})),i.select("#earlierAmount").select("text").data([e.earlier_amount]).join("text").attr("text-anchor","middle").attr("class","earlier-amount").text((function(t){return t}))}),e),style:i})};var at=function(){var t=Object(s.c)(I);return Object(Y.jsx)(U.a,{fluid:!0,children:Object(Y.jsx)(H.a,{children:Object(Y.jsx)(G.a,{children:t.view_type===A.barchart?Object(Y.jsx)(tt,{top_margin:"20",right_margin:"30",bottom_margin:"30",left_margin:"80"}):t.view_type===A.word?Object(Y.jsx)(X,{}):Object(Y.jsx)(nt,{top_margin:"20",right_margin:"20",bottom_margin:"30",left_margin:"30"})})})})},rt=n(119),it=n.n(rt);function ct(){var t=Object(s.b)(),e=Object(s.c)(T),n=Object(L.g)().search,r=new URLSearchParams(n).get("participant_id"),i=new URLSearchParams(n).get("question_set_id");return t(R(r)),t(Z(i)),Object(a.useEffect)((function(){e===w&&t(z(i))}),[e,t]),Object(Y.jsx)("div",{children:e===q&&Object(Y.jsx)(it.a,{type:"spinningBubbles",color:"#444"})})}var st=n(120),ot=function(){var t=Object(s.c)(I);return Object(Y.jsxs)("div",{className:"footer",children:["Version: ",st.a,Object(Y.jsx)("div",{className:"stickRight",children:t?t.comment:""})]})},ut=function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(B.a,{children:Object(Y.jsxs)("div",{className:"App",children:[Object(Y.jsxs)(P.a,{bg:"dark",variant:"dark",expand:"lg",children:[Object(Y.jsx)(P.a.Brand,{as:B.b,to:"/",children:"Viz Survey"}),Object(Y.jsx)(P.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(Y.jsx)(P.a.Collapse,{id:"basic-navbar-nav",children:Object(Y.jsx)(V.a,{className:"mr-auto",children:Object(Y.jsx)(V.a.Item,{href:"/survey",children:Object(Y.jsx)(V.a.Link,{as:B.b,to:"/survey",children:"Survey"})})})})]}),Object(Y.jsx)(ct,{}),Object(Y.jsxs)(L.d,{children:[Object(Y.jsx)(L.b,{exact:!0,path:"/",component:lt}),Object(Y.jsx)(L.b,{path:"/survey",component:at}),Object(Y.jsx)(L.b,{path:"/thankyou",component:dt}),Object(Y.jsx)(L.b,{path:"/*",component:lt})]}),Object(Y.jsx)(ot,{className:"footer bg-dark"})]})})})},lt=function(){return Object(Y.jsxs)("div",{id:"home-text",children:[Object(Y.jsx)("p",{children:"*** TODO: Inert the survey instructions for the subject here ***"}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{href:" https://github.com/pcordone/vizsurvey",children:"Github README.md"})}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{id:"getQuestionSet",href:"http://localhost:3000/vizsurvey?participant_id=1&question_set_id=2",children:"localhost"})}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{href:"https://pcordone.github.io/vizsurvey/?participant_id=1&question_set_id=2",children:"localhost"})})]})};var dt=function(){var t=Object(s.b)(),e=function(t){var e=t.map((function(t){return"".concat(t.question_set_id,", ").concat(t.position,", ").concat(t.amount_earlier,", ").concat(t.time_earlier,", ").concat(t.amount_later,", ").concat(t.time_later,", ").concat(t.choice,", ").concat(t.answer_time,", ").concat(t.participant_id)}));return["question_set_id,position,amount_earlier,time_earlier,amount_later,time_later,choice,answer_time,participant_id"].concat(e).join("\n")}(Object(s.c)(M));return console.log(e),t(D(e)),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("p",{children:"Your answers have been submitted. Thank you for taking this survey!"}),"."]})},bt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};c.a.render(Object(Y.jsx)(r.a.StrictMode,{children:Object(Y.jsx)(s.a,{store:J,children:Object(Y.jsx)(ut,{})})}),document.getElementById("root")),bt()}},[[247,1,2]]]);
//# sourceMappingURL=main.ac0946eb.chunk.js.map