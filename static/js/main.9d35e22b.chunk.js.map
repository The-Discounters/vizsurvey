{"version":3,"sources":["features/treatments.js","features/Question.js","features/ViewType.js","features/InteractionType.js","features/AmountType.js","features/FileIOAdapter.js","features/StatusType.js","features/ChoiceType.js","features/Answer.js","features/questionSlice.js","features/QuestionEngine.js","app/store.js","components/MELForm.js","hooks/useD3.js","components/BarChart.js","components/CalendarHelper.js","components/Calendar.js","components/CalendarYear.js","components/Survey.js","features/postsurveyquestions.js","components/PostSurvey.js","components/QueryParam.js","App.js","reportWebVitals.js","index.js"],"names":["TREATMENTS_CSV","Question","treatmentId","position","viewType","interaction","variableAmount","amountEarlier","timeEarlier","dateEarlier","amountLater","timeLater","dateLater","maxAmount","maxTime","horizontalPixels","verticalPixels","leftMarginWidthIn","bottomMarginHeightIn","graphWidthIn","graphHeightIn","widthIn","heightIn","comment","this","highup","lowdown","ViewType","word","barchart","calendarBar","calendarWord","calendarIcon","Object","freeze","InteractionType","none","drag","titration","AmountType","earlierAmount","laterAmount","FileIOAdapter","loadAllTreatments","csvParse","e","fromCSVRow","sort","a","b","fetchQuestions","filter","d","writeAnswers","answersCSV","getState","state","console","log","JSON","stringify","row","treatment_id","undefined","view_type","variable_amount","amount_earlier","time_earlier","date_earlier","DateTime","fromFormat","amount_later","time_later","date_later","max_amount","max_time","horizontal_pixels","vertical_pixels","left_margin_width_in","bottom_margin_height_in","graph_width_in","graph_height_in","width_in","height_in","answers","rows","map","choice","shownTimestamp","choiceTimestamp","participantCode","concat","join","StatusType","Unitialized","Fetching","Fetched","Complete","Error","ChoiceType","unitialized","earlier","later","Answer","dragAmount","qe","treatments","currentQuestionIdx","treatment","currentTreatment","latestAnswer","length","answer","push","createNextAnswer","action","payload","isLastTreatment","status","currentTreatmentAndLatestAnswer","possibleHighup","possibleLowdown","assert","titratingAmount","override","titrationAmount","adjustmentAmount","parseInt","toFormat","incNextQuestion","calcTitrationAmount","updateHighupOrLowdown","newAmount","calcNewAmount","io","createAsyncThunk","questionSlice","createSlice","name","initialState","allTreatments","participantId","fetchAllTreatmentsStatus","error","reducers","setParticipant","setTreatmentId","startSurvey","setQuestionShownTimestamp","setLatestAnswerShown","answerCurrentQuestion","selectAllQuestions","allQuestions","questions","fetchCurrentTreatment","fetchAllTreatments","selectCurrentQuestion","fetchStatus","fetchTreatmentId","actions","store","configureStore","reducer","questionReducer","middleware","getDefaultMiddleware","MELForm","dispatch","useDispatch","q","useSelector","dpi","window","devicePixelRatio","question1stPartText","sooner_time","question2ndPartText","result","width","Math","round","height","overflow","initialValues","validate","values","errors","onSubmit","setSubmitting","resetForm","setTimeout","local","isSubmitting","role","className","type","value","style","color","fontWeight","component","Button","disabled","to","Date","now","useD3","renderChartFn","dependencies","ref","React","useRef","useEffect","d3","current","BarChart","minScreenRes","min","screen","totalWidthUC","totalHeightUC","barAreaWidthIn","barAreaHeightIn","totalSVGWidthIn","totalSVGHeightIn","scaleHorizUCPerIn","leftOffSetUC","barAreaWidthUC","barAreaHeightUC","barWidth","pixelRatioScale","xTickValues","Array","from","keys","data","time","amount","barType","viewBox","svg","chart","selectAll","attr","x","scaleLinear","domain","range","yRange","y","call","axisBottom","tickValues","tickFormat","format","yTickValues","axisLeft","on","target","__data__","subject","select","dragHandler","calendarMatrix","require","dayNames","drawCalendar","yIcon","xIcon","yBar","table","question","monthDate","tableWidthIn","showYear","showAmountOnBar","numIconCol","numIconRow","dragCallback","dispatchCallback","tableSquareSizeIn","tableSquareSizePx","monthDays","toJSDate","monthDaysAmounts","week","day","date","year","month","equals","lastDayOfMonth","max","firstDaysOfWeek","reduce","acc","cv","iconAmtInc","iconAmtData","amtToIconIdx","floor","iconSize","thead","text","monthLong","tbody","updateBar","parent","idPrefix","updateWord","enter","append","each","dayAndAmount","td","includes","node","clientHeight","scaleBand","drawBar","iconIdx","update","exit","remove","drawIcon","invert","Calendar","id","borderCollapse","tableLayout","monthsMatrix","firstOfMonth","hasEarlierDate","hasLaterDate","monthTdSquareSizeIn","monthTdSquareSizePx","yearTable","yearTd","Survey","monthsApart","diff","toObject","months","top","left","marginRight","transform","CalendarYear","POST_SURVEY_QUESTIONS","textFull","textShort","options","divCenterContentStyle1","PostSurvey","history","useHistory","currentObj","key","index","option","index1","QueryParam","search","useLocation","URLSearchParams","get","App","exact","path","Home","Instructions","ThankYou","href","divCenterContentStyle","buttonCenterContentStyle","handle","useFullScreenHandle","size","onClick","uuid","uuidv4","csv","convertToCSV","readOnly","navigator","clipboard","writeText","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","enableAllPlugins","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9d35e22b.chunk.js","sourcesContent":["export const TREATMENTS_CSV = `treatment_id,position,view_type,interaction,variable_amount,amount_earlier,time_earlier,date_earlier,amount_later,time_later,date_later,max_amount,max_time,horizontal_pixels,vertical_pixels,left_margin_width_in,bottom_margin_height_in,graph_width_in,graph_height_in,width_in,height_in,comment\n1,1,word,none,none,500,2,,1000,5,,,10,,,,,,,4,4,Worded with no interaction and Read 2001 example values.\n1,2,word,none,none,50,2,,300,7,,,10,,,,,,,8,8,Worded with no interaction and Read 2001 example values.\n1,3,word,none,none,250,2,,1000,3,,,10,,,,,,,8,8,Worded with no interaction and Read 2001 example values.\n2,1,barchart,none,none,300,2,,700,5,,1100,10,100,100,0.5,0.5,8,8,8.5,8.5,Barchart MEL question with no interaction.\n2,2,barchart,none,none,500,2,,800,7,,1100,15,100,100,0.5,0.5,8,8,8.5,8.5,Barchart with no interaction.\n2,3,barchart,none,none,300,2,,1000,7,,1100,15,100,100,0.5,0.5,4,4,4.5,4.5,Barchart with no interaction.\n3,1,calendarBar,none,none,300,,2/1/2022,700,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with barchart and no interaction.\n3,2,calendarBar,none,none,500,,3/1/2022,800,,3/12/2022,1100,,100,100,,,,,8,8,Calendar month view with barchart and no interaction.\n3,3,calendarBar,none,none,300,,4/1/2022,1000,,4/15/2022,1100,,100,100,,,,,8,8,Calendar month view with barchart and no interaction.\n4,1,calendarWord,none,none,300,,2/1/2022,700,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with word and no interaction.\n4,2,calendarWord,none,none,500,,3/1/2022,800,,3/12/2022,1100,,100,100,,,,,8,8,Calendar month view with word and no interaction.\n4,3,calendarWord,none,none,300,,4/1/2022,1000,,4/15/2022,1100,,100,100,,,,,8,8,Calendar month view with word and no interaction.\n5,1,barchart,drag,laterAmount,500,2,,1000,10,,1500,10,100,100,0.5,0.5,8,8,8.5,8.5,Barchart with drag interaction.\n6,1,calendar,drag,laterAmount,500,,2/1/2022,1000,,2/22/2022,1100,,100,100,,,,,8,8,\"Read 2001 example, absolute size\"\n7,1,word,titration,laterAmount,500,2,,1000,3,,,10,,,,,,,8,8,Word with titration interaction.\n8,1,barchart,titration,laterAmount,500,2,,1000,10,,1500,10,100,100,0.5,0.5,8,8,8.5,8.5,Barchat with titration interaction.\n9,1,calendarBar,titration,laterAmount,500,,2/1/2022,1000,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with barchart and titration interaction.\n10,1,calendarWord,titration,laterAmount,500,,2/1/2022,1000,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with word and titration interaction.\n11,1,calendarBar,drag,laterAmount,500,,2/1/2022,1000,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with barchart and drag interaction.\n12,1,calendarWord,titration,laterAmount,500,,2/1/2022,1000,,10/1/2022,1100,,100,100,,,,,10,8,Calendar year view with word and titration interaction.\n13,1,calendarBar,drag,laterAmount,500,,2/1/2022,1000,,10/1/2022,1100,,100,100,,,,,10,8,Calendar year view with barchart and drag interaction.\n14,1,calendarWord,none,none,300,,2/1/2022,700,,5/22/2022,1100,,100,100,,,,,10,8,Calendar year view with word and no interaction.\n14,2,calendarWord,none,none,500,,3/1/2022,800,,6/12/2022,1100,,100,100,,,,,10,8,Calendar year view with word and no interaction.\n14,3,calendarWord,none,none,300,,4/1/2022,1000,,7/15/2022,1100,,100,100,,,,,10,8,Calendar year view with word and no interaction.\n15,1,calendarBar,none,none,300,,2/1/2022,700,,5/22/2022,1100,,100,100,,,,,10,8,Calendar year view with bar and no interaction.\n15,2,calendarBar,none,none,500,,3/1/2022,800,,6/12/2022,1100,,100,100,,,,,10,8,Calendar year view with bar and no interaction.\n15,3,calendarBar,none,none,300,,4/1/2022,1000,,7/15/2022,1100,,100,100,,,,,10,8,Calendar year view with bar and no interaction.\n16,1,calendarIcon,none,none,300,,2/1/2022,700,,5/22/2022,1100,,100,100,,,,,10,8,Calendar year view with icon and no interaction.\n16,2,calendarIcon,none,none,500,,3/1/2022,800,,6/12/2022,1100,,100,100,,,,,10,8,Calendar year view with icon and no interaction.\n16,3,calendarIcon,none,none,300,,4/1/2022,1000,,7/15/2022,1100,,100,100,,,,,10,8,Calendar year view with icon and no interaction.\n17,1,calendarIcon,none,none,300,,2/1/2022,700,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with icon and no interaction.\n17,2,calendarIcon,none,none,500,,3/1/2022,800,,3/12/2022,1100,,100,100,,,,,8,8,Calendar month view with icon and no interaction.\n17,3,calendarIcon,none,none,300,,4/1/2022,1000,,4/15/2022,1100,,100,100,,,,,8,8,Calendar month view with icon and no interaction.\n18,1,calendarIcon,titration,laterAmount,300,,2/1/2022,700,,2/22/2022,1100,,100,100,,,,,8,8,Calendar month view with icon and titration interaction.\n`;\n","export class Question {\n  constructor({\n    treatmentId,\n    position,\n    viewType,\n    interaction,\n    variableAmount,\n    amountEarlier,\n    timeEarlier,\n    dateEarlier,\n    amountLater,\n    timeLater,\n    dateLater,\n    maxAmount,\n    maxTime,\n    horizontalPixels,\n    verticalPixels,\n    leftMarginWidthIn,\n    bottomMarginHeightIn,\n    graphWidthIn,\n    graphHeightIn,\n    widthIn,\n    heightIn,\n    comment,\n  }) {\n    this.treatmentId = treatmentId;\n    this.position = position;\n    this.viewType = viewType;\n    this.interaction = interaction;\n    this.variableAmount = variableAmount;\n    this.amountEarlier = amountEarlier;\n    this.timeEarlier = timeEarlier;\n    this.dateEarlier = dateEarlier;\n    this.amountLater = amountLater;\n    this.timeLater = timeLater;\n    this.dateLater = dateLater;\n    this.maxAmount = maxAmount;\n    this.maxTime = maxTime;\n    this.horizontalPixels = horizontalPixels;\n    this.verticalPixels = verticalPixels;\n    this.leftMarginWidthIn = leftMarginWidthIn;\n    this.bottomMarginHeightIn = bottomMarginHeightIn;\n    this.graphWidthIn = graphWidthIn;\n    this.graphHeightIn = graphHeightIn;\n    this.widthIn = widthIn;\n    this.heightIn = heightIn;\n    this.comment = comment;\n    this.highup = null;\n    this.lowdown = null;\n  }\n}\n","export const ViewType = {\n  word: \"word\",\n  barchart: \"barchart\",\n  calendarBar: \"calendarBar\",\n  calendarWord: \"calendarWord\",\n  calendarIcon: \"calendarIcon\",\n};\n\nObject.freeze(ViewType);\n","export const InteractionType = {\n  none: \"none\",\n  drag: \"drag\",\n  titration: \"titration\",\n};\n\nObject.freeze(InteractionType);\n","export const AmountType = {\n  none: \"none\",\n  earlierAmount: \"earlierAmount\",\n  laterAmount: \"laterAmount\",\n};\n\nObject.freeze(AmountType);\n","import { csvParse } from \"d3\";\n// import { Octokit } from \"octokit\";\nimport { DateTime } from \"luxon\";\nimport { TREATMENTS_CSV } from \"./treatments\";\nimport { Question } from \"./Question\";\nimport { ViewType } from \"./ViewType\";\nimport { InteractionType } from \"./InteractionType\";\nimport { AmountType } from \"./AmountType\";\n\nexport class FileIOAdapter {\n  constructor() {}\n\n  loadAllTreatments = () => {\n    const treatments = csvParse(TREATMENTS_CSV, (e) => {\n      return this.fromCSVRow(e);\n    }).sort((a, b) =>\n      a.position < b.position ? -1 : a.position === b.position ? 0 : 1\n    );\n    return treatments;\n  };\n\n  fetchQuestions = (treatmentId) => {\n    treatmentId = +treatmentId;\n    const questions = csvParse(TREATMENTS_CSV, (e) => {\n      return this.fromCSVRow(e);\n    })\n      .filter((d) => d.treatmentId === treatmentId)\n      .sort((a, b) =>\n        a.position < b.position ? -1 : a.position === b.position ? 0 : 1\n      );\n    return questions;\n  };\n\n  fromCSVRow(row) {\n    return new Question({\n      treatmentId: row.treatment_id ? +row.treatment_id : undefined,\n      position: row.position ? +row.position : undefined,\n      viewType: row.view_type ? ViewType[row.view_type] : undefined,\n      interaction: row.interaction\n        ? InteractionType[row.interaction]\n        : undefined,\n      variableAmount: row.variable_amount\n        ? AmountType[row.variable_amount]\n        : undefined,\n      amountEarlier: row.amount_earlier ? +row.amount_earlier : undefined,\n      timeEarlier: row.time_earlier ? +row.time_earlier : undefined,\n      dateEarlier: row.date_earlier\n        ? DateTime.fromFormat(row.date_earlier, \"M/d/yyyy\")\n        : undefined,\n      amountLater: row.amount_later ? +row.amount_later : undefined,\n      timeLater: row.time_later ? +row.time_later : undefined,\n      dateLater: row.date_later\n        ? DateTime.fromFormat(row.date_later, \"M/d/yyyy\")\n        : undefined,\n      maxAmount: row.max_amount ? +row.max_amount : undefined,\n      maxTime: row.max_time ? +row.max_time : undefined,\n      horizontalPixels: row.horizontal_pixels\n        ? +row.horizontal_pixels\n        : undefined,\n      verticalPixels: row.vertical_pixels ? +row.vertical_pixels : undefined,\n      leftMarginWidthIn: row.left_margin_width_in\n        ? +row.left_margin_width_in\n        : undefined,\n      bottomMarginHeightIn: row.bottom_margin_height_in\n        ? +row.bottom_margin_height_in\n        : undefined,\n      graphWidthIn: row.graph_width_in ? +row.graph_width_in : undefined,\n      graphHeightIn: row.graph_height_in ? +row.graph_height_in : undefined,\n      widthIn: row.width_in ? +row.width_in : undefined,\n      heightIn: row.height_in ? +row.height_in : undefined,\n      comment: row.comment,\n    });\n  }\n\n  convertToCSV(answers) {\n    const header = [\n      \"treatment_id,position,view_type,interaction,variable_amount,amount_earlier,time_earlier,date_earlier,amount_later,time_later,date_later,max_amount,max_time,vertical_pixels,horizontal_pixels,left_margin_width_in,bottom_margin_height_in,graph_width_in,graph_height_in,width_in,height_in,choice,shown_timestamp,choice_timestamp,highup,lowdown,participant_code\",\n    ];\n    const rows = answers.map(\n      (a) =>\n        `${a.treatmentId},${a.position},${a.viewType},${a.interaction},${a.variableAmount},${a.amountEarlier},${a.timeEarlier},${a.dateEarlier},${a.amountLater},${a.timeLater},${a.dateLater},${a.maxAmount},${a.maxTime},${a.verticalPixels},${a.horizontalPixels},${a.leftMarginWidthIn},${a.bottomMarginHeightIn},${a.graphWidthIn},${a.graphHeightIn},${a.widthIn},${a.heightIn},${a.choice},${a.shownTimestamp},${a.choiceTimestamp},${a.highup},${a.lowdown},${a.participantCode}`\n    );\n    return header.concat(rows).join(\"\\n\");\n  }\n\n  writeAnswers = async (answersCSV, { getState }) => {\n    const state = getState();\n    console.log(answersCSV);\n    console.log(JSON.stringify(state));\n    // const octokit = new Octokit({\n    //   userAgent: \"thesis_answers/v1.0\",\n    //   // eslint-disable-next-line no-undef\n    //   auth: atob(process.env.REACT_APP_AUTH_TOKEN),\n    // });\n    // // eslint-disable-next-line no-undef\n    // const gistAnswerId = process.env.REACT_APP_GIST_ANSWER_ID;\n    // const url = `PATCH /gists/${gistAnswerId}`;\n    // const now = DateTime.local().toFormat(\"yyyy-MM-dd-H-mm-ss-SSS-ZZZZ\");\n    // const files = {};\n    // answersCSV = `${answersCSV}`;\n    // files[`answers-subject-${state.questions.participant_id}-${now}.csv`] = {\n    //   content: answersCSV,\n    // };\n    // const description = `Answer results for participant ${state.questions.participant_id} at ${now}`;\n    // console.log(\"submitting answers for \" + description);\n    // const payloadObj = {\n    //   gist_id: gistAnswerId,\n    //   description: description,\n    //   files: files,\n    // };\n    // const response = await octokit.request(url, payloadObj);\n\n    // const status = response.status;\n    // console.log(\"answers submitted with status of \" + status);\n  };\n}\n","export const StatusType = {\n  Unitialized: \"Unitialized\",\n  Fetching: \"Fetching\",\n  Fetched: \"Fetched\",\n  Complete: \"Complete\",\n  Error: \"Error\",\n};\n\nObject.freeze(StatusType);\n","export const ChoiceType = {\n  unitialized: \"unitialized\",\n  earlier: \"earlier\",\n  later: \"later\",\n};\n\nObject.freeze(ChoiceType);\n","export class Answer {\n  constructor({\n    treatmentId: treatmentId,\n    position: position,\n    viewType: viewType,\n    interaction: interaction,\n    variableAmount: variableAmount,\n    amountEarlier: amountEarlier,\n    timeEarlier: timeEarlier,\n    dateEarlier: dateEarlier,\n    amountLater: amountLater,\n    timeLater: timeLater,\n    dateLater: dateLater,\n    maxAmount: maxAmount,\n    maxTime: maxTime,\n    verticalPixels: verticalPixels,\n    horizontalPixels: horizontalPixels,\n    leftMarginWidthIn: leftMarginWidthIn,\n    bottomMarginHeightIn: bottomMarginHeightIn,\n    graphWidthIn: graphWidthIn,\n    graphHeightIn: graphHeightIn,\n    widthIn: widthIn,\n    heightIn: heightIn,\n    choice: choice,\n    dragAmount: dragAmount,\n    shownTimestamp: shownTimestamp,\n    choiceTimestamp: choiceTimestamp,\n    highup: highup,\n    lowdown: lowdown,\n    participantCode: participantCode,\n  }) {\n    this.treatmentId = treatmentId;\n    this.position = position;\n    this.viewType = viewType;\n    this.interaction = interaction;\n    this.variableAmount = variableAmount;\n    this.amountEarlier = amountEarlier;\n    this.timeEarlier = timeEarlier;\n    this.dateEarlier = dateEarlier;\n    this.amountLater = amountLater;\n    this.timeLater = timeLater;\n    this.dateLater = dateLater;\n    this.maxAmount = maxAmount;\n    this.maxTime = maxTime;\n    this.verticalPixels = verticalPixels;\n    this.horizontalPixels = horizontalPixels;\n    this.leftMarginWidthIn = leftMarginWidthIn;\n    this.bottomMarginHeightIn = bottomMarginHeightIn;\n    this.graphWidthIn = graphWidthIn;\n    this.graphHeightIn = graphHeightIn;\n    this.widthIn = widthIn;\n    this.heightIn = heightIn;\n    this.choice = choice;\n    this.dragAmount = dragAmount;\n    this.shownTimestamp = shownTimestamp;\n    this.choiceTimestamp = choiceTimestamp;\n    this.highup = highup;\n    this.lowdown = lowdown;\n    this.participantCode = participantCode;\n  }\n}\n","import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { FileIOAdapter } from \"./FileIOAdapter\";\nimport { QuestionEngine } from \"./QuestionEngine\";\nimport { StatusType } from \"./StatusType\";\n\n// Define the initial state of the store for this slicer.\nconst qe = new QuestionEngine();\nconst io = new FileIOAdapter();\n\nexport const writeAnswers = createAsyncThunk(\n  \"survey/writeAnswers\",\n  io.writeAnswers\n);\n\nexport const questionSlice = createSlice({\n  name: \"questions\", // I believe the global state is partitioned by the name value thus the terminology \"slice\"\n  initialState: {\n    allTreatments: null,\n    treatmentId: null,\n    participantId: null,\n    treatments: [],\n    answers: [],\n    currentQuestionIdx: 0,\n    highup: undefined,\n    lowdown: undefined,\n    status: StatusType.Unitialized,\n    fetchAllTreatmentsStatus: StatusType.Unitialized,\n    error: null,\n  }, // the initial state of our global data (under name slice)\n  reducers: {\n    setParticipant(state, action) {\n      state.participantId = action.payload;\n      return state;\n    },\n    setTreatmentId(state, action) {\n      state.treatmentId = action.payload;\n      return state;\n    },\n    fetchQuestions(state) {\n      state.treatments = io.fetchQuestions(state.treatmentId);\n      state.status = StatusType.Fetched;\n      return state;\n    },\n    loadAllTreatments(state) {\n      state.allTreatments = io.loadAllTreatments();\n      state.fetchAllTreatmentsStatus = StatusType.Fetched;\n    },\n    startSurvey(state) {\n      qe.startSurvey(state);\n      return state;\n    },\n    setQuestionShownTimestamp(state, action) {\n      qe.setLatestAnswerShown(state, action);\n      return state;\n    },\n    // we define our actions on the slice of global store data here.\n    answer(state, action) {\n      qe.answerCurrentQuestion(state, action);\n    },\n  },\n});\n\nexport const selectAllQuestions = (state) => {\n  return qe.allQuestions(state.questions);\n};\n\nexport const fetchCurrentTreatment = (state) => {\n  const result = qe.currentTreatment(state.questions);\n  return result;\n};\n\nexport const fetchAllTreatments = (state) => {\n  return state.questions.allTreatments;\n};\n\nexport const selectCurrentQuestion = (state) => {\n  return qe.latestAnswer(state.questions);\n};\n\nexport const fetchStatus = (state) => {\n  return state.questions.status;\n};\n\nexport const fetchAllTreatmentsStatus = (state) => {\n  return state.questions.fetchAllTreatmentsStatus;\n};\n\nexport const fetchTreatmentId = (state) => {\n  return state.questions.treatmentId;\n};\n\n// Action creators are generated for each case reducer function\nexport const {\n  fetchQuestions,\n  loadAllTreatments,\n  startSurvey,\n  setQuestionShownTimestamp,\n  answer,\n  setParticipant,\n  setTreatmentId,\n} = questionSlice.actions;\n\nexport default questionSlice.reducer;\n","import { StatusType } from \"./StatusType\";\nimport { AmountType } from \"./AmountType\";\nimport { InteractionType } from \"./InteractionType\";\nimport { ChoiceType } from \"./ChoiceType\";\nimport { Answer } from \"./Answer\";\n\nexport const TIMESTAMP_FORMAT = \"MM/dd/yyyy H:mm:ss:SSS ZZZZ\";\n\n// TODO Need to capture errors in processing by settings state.status = StatusType.Error\nexport class QuestionEngine {\n  constructor() {}\n\n  currentTreatment(state) {\n    return state.treatments[state.currentQuestionIdx];\n  }\n\n  currentTreatmentAndLatestAnswer(state) {\n    const treatment = this.currentTreatment(state);\n    const latestAnswer = this.latestAnswer(state);\n\n    return { treatment, latestAnswer };\n  }\n\n  latestAnswer(state) {\n    return state.answers.length === 0\n      ? null\n      : state.answers[state.answers.length - 1];\n  }\n\n  createNextAnswer(\n    treatment,\n    answers,\n    amountEarlier,\n    amountLater,\n    highup,\n    lowdown\n  ) {\n    const answer = new Answer({\n      treatmentId: treatment.treatmentId,\n      position: treatment.position,\n      viewType: treatment.viewType,\n      interaction: treatment.interaction,\n      variableAmount: treatment.variableAmount,\n      amountEarlier: amountEarlier,\n      timeEarlier: treatment.timeEarlier,\n      dateEarlier: treatment.dateEarlier,\n      amountLater: amountLater,\n      timeLater: treatment.timeLater,\n      dateLater: treatment.dateLater,\n      maxAmount: treatment.maxAmount,\n      maxTime: treatment.maxTime,\n      verticalPixels: treatment.verticalPixels,\n      horizontalPixels: treatment.horizontalPixels,\n      leftMarginWidthIn: treatment.leftMarginWidthIn,\n      bottomMarginHeightIn: treatment.bottomMarginHeightIn,\n      graphWidthIn: treatment.graphWidthIn,\n      graphHeightIn: treatment.graphHeightIn,\n      widthIn: treatment.widthIn,\n      heightIn: treatment.heightIn,\n      choice: ChoiceType.unitialized,\n      highup: highup,\n      lowdown: lowdown,\n    });\n    answers.push(answer);\n  }\n\n  allQuestions(state) {\n    return state.answers;\n  }\n\n  startSurvey(state) {\n    state.currentQuestionIdx = 0;\n    const treatment = this.currentTreatment(state);\n    state.highup =\n      treatment.variableAmount === AmountType.laterAmount\n        ? treatment.amountEarlier\n        : treatment.amountLater;\n    state.lowdown = undefined;\n    this.createNextAnswer(\n      treatment,\n      state.answers,\n      treatment.amountEarlier,\n      treatment.amountLater,\n      state.highup,\n      state.lowdown\n    );\n  }\n\n  setLatestAnswerShown(state, action) {\n    this.latestAnswer(state).shownTimestamp = action.payload;\n  }\n\n  isLastTreatment(state) {\n    return state.currentQuestionIdx === state.treatments.length - 1;\n  }\n\n  incNextQuestion(state) {\n    if (this.isLastTreatment(state)) {\n      state.status = StatusType.Complete;\n    } else {\n      state.currentQuestionIdx += 1;\n      const treatment = this.currentTreatment(state);\n      this.createNextAnswer(\n        treatment,\n        state.answers,\n        treatment.amountEarlier,\n        treatment.amountLater\n      );\n    }\n  }\n\n  updateHighupOrLowdown(state) {\n    const { treatment, latestAnswer } =\n      this.currentTreatmentAndLatestAnswer(state);\n    switch (latestAnswer.choice) {\n      case ChoiceType.earlier:\n        var possibleHighup =\n          treatment.variableAmount === AmountType.laterAmount\n            ? latestAnswer.amountLater\n            : latestAnswer.amountEarlier;\n        if (!state.highup || possibleHighup > state.highup)\n          state.highup = possibleHighup;\n        break;\n      case ChoiceType.later:\n        var possibleLowdown =\n          treatment.variableAmount === AmountType.laterAmount\n            ? latestAnswer.amountLater\n            : latestAnswer.amountEarlier;\n        if (!state.lowdown || possibleLowdown < state.lowdown)\n          state.lowdown = possibleLowdown;\n        break;\n      default:\n        console.assert(\n          true,\n          \"Invalid value for current answer in setAnswerCurrentQuestion\"\n        );\n        break;\n    }\n  }\n\n  calcTitrationAmount(titratingAmount, highup, override) {\n    return (override ? override : titratingAmount - highup) / 2;\n  }\n\n  calcNewAmount(state, titrationAmount) {\n    const { treatment, latestAnswer } =\n      this.currentTreatmentAndLatestAnswer(state);\n    var adjustmentAmount;\n    switch (treatment.variableAmount) {\n      case AmountType.laterAmount:\n        console.assert(\n          latestAnswer.choice && latestAnswer.choice !== ChoiceType.unitialized\n        );\n        adjustmentAmount =\n          latestAnswer.choice === ChoiceType.earlier\n            ? titrationAmount\n            : -1 * titrationAmount;\n        return (\n          parseInt((latestAnswer.amountLater + adjustmentAmount) / 10) * 10\n        );\n      case AmountType.earlierAmount:\n        adjustmentAmount =\n          latestAnswer.choice === ChoiceType.earlier\n            ? -1 * titrationAmount\n            : titrationAmount;\n        return (\n          parseInt((latestAnswer.amountEarlier + adjustmentAmount) / 10) * 10\n        );\n      default:\n        console.assert(\n          true,\n          \"Invalid value for question titration type in calcEarlierAndLaterAmounts\"\n        );\n        break;\n    }\n  }\n\n  answerCurrentQuestion(state, action) {\n    const { treatment, latestAnswer } =\n      this.currentTreatmentAndLatestAnswer(state);\n    latestAnswer.choice = action.payload.choice;\n    latestAnswer.choiceTimestamp =\n      action.payload.choiceTimestamp.toFormat(TIMESTAMP_FORMAT);\n    latestAnswer.dragAmount = action.payload.dragAmount;\n    if (\n      treatment.interaction === InteractionType.none ||\n      treatment.interaction === InteractionType.drag\n    ) {\n      this.incNextQuestion(state);\n    } else if (treatment.interaction === InteractionType.titration) {\n      const titrationAmount = this.calcTitrationAmount(\n        treatment.variableAmount === AmountType.laterAmount\n          ? latestAnswer.amountLater\n          : latestAnswer.amountEarlier,\n        state.highup,\n        latestAnswer.length === 1 ? state.highup : null\n      );\n      this.updateHighupOrLowdown(state);\n      // TODO we need a termination condition for runaway titration\n      if (state.lowdown - state.highup <= 10) {\n        this.incNextQuestion(state);\n      } else {\n        const newAmount = this.calcNewAmount(state, titrationAmount);\n        if (treatment.variableAmount === AmountType.laterAmount) {\n          this.createNextAnswer(\n            treatment,\n            state.answers,\n            treatment.amountEarlier,\n            newAmount\n          );\n        } else if (treatment.variableAmount === AmountType.earlierAmount) {\n          this.createNextAnswer(\n            treatment,\n            state.answers,\n            newAmount,\n            treatment.amountLater\n          );\n        } else {\n          console.assert(\n            true,\n            \"Titration not set to amountEarlier or amountLater before calling answerCurrentQuestion\"\n          );\n        }\n      }\n    }\n  }\n}\n","import { configureStore } from \"@reduxjs/toolkit\";\nimport questionReducer from \"../features/questionSlice\";\n\nexport const store = configureStore({\n  reducer: {\n    questions: questionReducer,\n  },\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware(),\n});\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { DateTime } from \"luxon\";\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\nimport { Button } from \"react-bootstrap\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { StatusType } from \"../features/StatusType\";\nimport {\n  selectCurrentQuestion,\n  fetchStatus,\n  setQuestionShownTimestamp,\n  answer,\n} from \"../features/questionSlice\";\n\nexport function MELForm() {\n  const dispatch = useDispatch();\n  const q = useSelector(selectCurrentQuestion);\n  const status = useSelector(fetchStatus);\n\n  const dpi = window.devicePixelRatio >= 2 ? 132 : 96;\n\n  const todayText = (sooner_time) =>\n    sooner_time === 0 ? \"today\" : `in ${sooner_time} weeks`;\n\n  function questionText() {\n    return `Make a choice to received ${question1stPartText()} or ${question2ndPartText()}`;\n  }\n\n  function question1stPartText() {\n    return `$${q.amountEarlier} ${todayText(q.timeEarlier)}`;\n  }\n\n  function question2ndPartText() {\n    return `$${q.amountLater} in ${q.timeLater} weeks`;\n  }\n\n  const result = (\n    <div\n      width={`${Math.round(q.widthIn * dpi)}px`}\n      height={`${Math.round(q.heightIn * dpi)}px`}\n      overflow=\"hidden\"\n    >\n      <Formik\n        initialValues={{ choice: ChoiceType.unitialized }}\n        validate={(values) => {\n          let errors = {};\n          if (!values.choice || values.choice === ChoiceType.unitialized) {\n            errors.choice = \"Please choose a selection to continue.\";\n          }\n          return errors;\n        }}\n        onSubmit={(values, { setSubmitting, resetForm }) => {\n          setTimeout(() => {\n            dispatch(\n              answer({\n                choice: values.choice,\n                choiceTimestamp: DateTime.local(),\n              })\n            );\n            setSubmitting(false);\n            resetForm();\n          }, 400);\n        }}\n      >\n        {({ isSubmitting }) => (\n          <Form>\n            <div\n              role=\"group\"\n              aria-labelledby=\"my-radio-group\"\n              className=\"radio-choice-label\"\n            >\n              <p>{questionText()} </p>\n              <label>\n                <Field type=\"radio\" name=\"choice\" value={ChoiceType.earlier} />\n                &nbsp;{question1stPartText()}\n              </label>\n              <br></br>\n              <label>\n                <Field type=\"radio\" name=\"choice\" value={ChoiceType.later} />\n                &nbsp;{question2ndPartText()}\n              </label>\n              <span style={{ color: \"red\", fontWeight: \"bold\" }}>\n                <ErrorMessage name=\"choice\" component=\"div\" />\n              </span>\n            </div>\n            <Button type=\"submit\" disabled={isSubmitting}>\n              Submit\n            </Button>\n          </Form>\n        )}\n      </Formik>\n    </div>\n  );\n\n  if (status === StatusType.Complete) {\n    return <Redirect to=\"/vizsurvey/post-survey\" />;\n  } else {\n    dispatch(setQuestionShownTimestamp(Date.now()));\n    return result;\n  }\n}\n\nexport default MELForm;\n","import React from \"react\";\nimport * as d3 from \"d3\";\n\nexport const useD3 = (renderChartFn, dependencies) => {\n  const ref = React.useRef();\n\n  React.useEffect(() => {\n    renderChartFn(d3.select(ref.current));\n    return () => {};\n  }, dependencies);\n\n  return ref;\n};\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n  axisBottom,\n  axisLeft,\n  scaleLinear,\n  range,\n  format,\n  drag,\n  select,\n} from \"d3\";\nimport { Formik, Form } from \"formik\";\nimport { Button } from \"react-bootstrap\";\nimport { DateTime } from \"luxon\";\nimport { useD3 } from \"../hooks/useD3\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { StatusType } from \"../features/StatusType\";\nimport { InteractionType } from \"../features/InteractionType\";\nimport { AmountType } from \"../features/AmountType\";\nimport {\n  selectCurrentQuestion,\n  fetchStatus,\n  setQuestionShownTimestamp,\n  answer,\n} from \"../features/questionSlice\";\n\nfunction BarChart() {\n  const dispatch = useDispatch();\n  const q = useSelector(selectCurrentQuestion);\n  const status = useSelector(fetchStatus);\n\n  const minScreenRes = Math.min(window.screen.height, window.screen.width);\n\n  const totalWidthUC = minScreenRes; //q.horizontalPixels; // may want to get rid of this configuation and just make it 100\n  const totalHeightUC = minScreenRes; //q.verticalPixels; // may want to get rid of this configuation and just make it 100\n  const leftMarginWidthIn = q.leftMarginWidthIn;\n  const bottomMarginHeightIn = q.bottomMarginHeightIn;\n  const barAreaWidthIn = q.graphWidthIn;\n  const barAreaHeightIn = q.graphHeightIn;\n\n  const totalSVGWidthIn = leftMarginWidthIn + barAreaWidthIn;\n  const totalSVGHeightIn = bottomMarginHeightIn + barAreaHeightIn;\n\n  const scaleHorizUCPerIn = totalWidthUC / totalSVGWidthIn;\n  const scaleVertUCPerIn = totalHeightUC / totalSVGHeightIn;\n\n  const leftOffSetUC = scaleHorizUCPerIn * leftMarginWidthIn;\n  const bottomOffSetUC = scaleVertUCPerIn * bottomMarginHeightIn;\n  const barAreaWidthUC = totalWidthUC - leftOffSetUC;\n  const barAreaHeightUC = totalHeightUC - bottomOffSetUC;\n\n  const barWidth = 0.15 * scaleHorizUCPerIn; // bars are 0.1 inch wide\n\n  // SVG thinks the resolution is 96 ppi when macbook is 132 ppi so we need to adjust by device pixel ratio\n  const pixelRatioScale = window.devicePixelRatio >= 2 ? 132 / 96 : 1;\n\n  console.log(`${totalWidthUC},${totalHeightUC},${pixelRatioScale}`);\n  console.log(\n    `${leftMarginWidthIn},${bottomMarginHeightIn},${barAreaWidthIn},${barAreaHeightIn}`\n  );\n  console.log(`${totalSVGWidthIn},${totalSVGHeightIn}`);\n\n  const xTickValues = Array.from(Array(q.maxTime + 1).keys());\n  const data = xTickValues.map((d) => {\n    if (d === q.timeEarlier) {\n      return {\n        time: d,\n        amount: q.amountEarlier,\n        barType: AmountType.earlierAmount,\n      };\n    } else if (d === q.timeLater) {\n      return {\n        time: d,\n        amount: q.amountLater,\n        barType: AmountType.laterAmount,\n      };\n    } else {\n      return { time: d, amount: 0, barType: AmountType.none };\n    }\n  });\n\n  const result = (\n    <div>\n      <svg\n        width={`${totalSVGWidthIn * pixelRatioScale}in`}\n        height={`${totalSVGHeightIn * pixelRatioScale}in`}\n        viewBox={`0 0 ${totalWidthUC} ${totalHeightUC}`}\n        ref={useD3(\n          (svg) => {\n            var chart = svg\n              .selectAll(\".plot-area\")\n              .data([null])\n              .join(\"g\")\n              .attr(\"class\", \"plot-area\");\n\n            const x = scaleLinear()\n              .domain([0, q.maxTime])\n              .range([0, barAreaWidthUC]);\n\n            const yRange = [0, q.maxAmount];\n            const y = scaleLinear().domain(yRange).range([barAreaHeightUC, 0]);\n\n            chart\n              .selectAll(\".x-axis\")\n              .data([null])\n              .join(\"g\")\n              .attr(\n                \"transform\",\n                `translate(${leftOffSetUC},${barAreaHeightUC})`\n              )\n              .attr(\"class\", \"x-axis\")\n              .call(\n                axisBottom(x).tickValues(xTickValues).tickFormat(format(\",.0f\"))\n              );\n\n            const yTickValues = range(yRange[0], yRange[1], yRange[1] / 5);\n            yTickValues.push(yRange[1]);\n\n            chart\n              .selectAll(\".y-axis\")\n              .data([null])\n              .join(\"g\")\n              .attr(\"class\", \"y-axis\")\n              .attr(\"transform\", `translate(${leftOffSetUC},0)`)\n              .call(\n                //axisLeft(y).tickValues(yTickValues).tickFormat(d3.format(\"$,.2f\"))\n                axisLeft(y).tickValues(yTickValues).tickFormat(format(\"$,.0f\"))\n              );\n\n            // const yLabelG = svg\n            //   .select(\"#y-axis-label\")\n            //   .data([1])\n            //   .join(\"g\")\n            //   .attr(\"transform\", \"rotate(-90)\");\n\n            // .data(nullData)\n            // .join(\"text\")\n            // .attr(\"id\", \"y-axis-label\")\n            // .attr(\"text-anchor\", \"middle\")\n            // .attr(\"x\", -innerHeight / 2)\n            // .attr(\"y\", -margin.left)\n\n            // .text(\"Amount in USD\");\n\n            chart\n              .selectAll(\".bar\")\n              .data(data)\n              .join(\"rect\")\n              .attr(\"id\", (d) => {\n                return \"id\" + d.time;\n              })\n              .attr(\"fill\", \"black\")\n              .attr(\"class\", \"bar\")\n              .attr(\"x\", (d) => x(d.time) - barWidth / 2)\n              .attr(\"y\", (d) => y(d.amount))\n              .attr(\"width\", barWidth)\n              .attr(\"height\", (d) => y(0) - y(d.amount))\n              .on(\"click\", (d) => {\n                if (\n                  q.interaction === InteractionType.titration ||\n                  q.interaction === InteractionType.none\n                ) {\n                  if (d.target.__data__.amount === q.amountEarlier) {\n                    dispatch(\n                      answer({\n                        choice: ChoiceType.earlier,\n                        choiceTimestamp: DateTime.local(),\n                      })\n                    );\n                  } else if (d.target.__data__.amount === q.amountLater) {\n                    dispatch(\n                      answer({\n                        choice: ChoiceType.later,\n                        choiceTimestamp: DateTime.local(),\n                      })\n                    );\n                  }\n                }\n              });\n            var dragHandler = drag().on(\"drag\", function (d) {\n              if (\n                q.interaction === InteractionType.drag &&\n                d.subject.barType === q.variableAmount\n              ) {\n                select(this)\n                  .attr(\"y\", d.y)\n                  .attr(\"height\", y(0) - d.y);\n              }\n            });\n            dragHandler(chart.selectAll(\".bar\"));\n          },\n          [q]\n        )}\n      ></svg>\n      {q.interaction === InteractionType.drag ? (\n        <Formik\n          initialValues={{ choice: ChoiceType.Unitialized }}\n          validate={() => {\n            let errors = {};\n            return errors;\n          }}\n          onSubmit={(values, { setSubmitting, resetForm }) => {\n            setTimeout(() => {\n              dispatch(\n                answer({\n                  choice: ChoiceType.earlier,\n                  choiceTimestamp: DateTime.local(),\n                })\n              );\n              setSubmitting(false);\n              resetForm();\n            }, 400);\n          }}\n        >\n          {({ isSubmitting }) => (\n            <Form>\n              <Button type=\"submit\" disabled={isSubmitting}>\n                Submit\n              </Button>\n            </Form>\n          )}\n        </Formik>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n\n  if (status === StatusType.Complete) {\n    return <Redirect to=\"/vizsurvey/post-survey\" />;\n  } else {\n    dispatch(setQuestionShownTimestamp(Date.now()));\n    return result;\n  }\n}\n\nexport default BarChart;\n","import * as d3 from \"d3\";\nimport { select, format, scaleLinear, scaleBand, range, drag } from \"d3\";\nimport { DateTime } from \"luxon\";\nimport { answer } from \"../features/questionSlice\";\nimport { ViewType } from \"../features/ViewType\";\nimport { AmountType } from \"../features/AmountType\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { InteractionType } from \"../features/InteractionType\";\n\nvar calendarMatrix = require(\"calendar-matrix\");\n\nexport const dayNames = [\"S\", \"M\", \"T\", \"W\", \"T\", \"F\", \"S\"];\n\nexport const drawCalendar = ({\n  table: table,\n  question: q,\n  monthDate: monthDate,\n  tableWidthIn: tableWidthIn,\n  showYear: showYear,\n  showAmountOnBar: showAmountOnBar,\n  numIconCol: numIconCol,\n  numIconRow: numIconRow,\n  dragCallback: dragCallback,\n  dispatchCallback: dispatchCallback,\n}) => {\n  const dpi = window.devicePixelRatio >= 2 ? 132 : 96;\n  const tableSquareSizeIn = tableWidthIn / 7;\n  const tableSquareSizePx = Math.round(tableSquareSizeIn * dpi);\n\n  const monthDays = calendarMatrix(monthDate.toJSDate());\n\n  const monthDaysAmounts = monthDays.map((week) =>\n    week.map((day) => {\n      const date =\n        day <= 0 ? null : DateTime.local(monthDate.year, monthDate.month, day);\n      return {\n        day: day,\n        amount:\n          date === null\n            ? null\n            : date.equals(q.dateEarlier)\n            ? q.amountEarlier\n            : date.equals(q.dateLater)\n            ? q.amountLater\n            : null,\n        type:\n          date === null\n            ? AmountType.none\n            : date.equals(q.dateEarlier)\n            ? AmountType.earlierAmount\n            : date.equals(q.dateLater)\n            ? AmountType.laterAmount\n            : AmountType.none,\n        date: date,\n      };\n    })\n  );\n\n  const lastDayOfMonth = Math.max(...[].concat(...monthDays));\n  const firstDaysOfWeek = monthDaysAmounts.reduce((acc, cv) => {\n    return acc.concat(cv[0].day);\n  }, []);\n\n  const yRange = [0, q.maxAmount];\n\n  const iconAmtInc = q.maxAmount / (numIconRow * numIconCol);\n  const iconAmtData = range(0, q.maxAmount, iconAmtInc);\n\n  const amtToIconIdx = (a) => Math.floor(a / iconAmtInc);\n  var yIcon;\n  var xIcon;\n  var yBar;\n\n  // TODO fix this hack of -4 on square size.\n  const iconSize = (tableSquareSizePx - 4) / numIconRow / 2;\n\n  const thead = table\n    .selectAll(\"#month-head\")\n    .data([null])\n    .join(\"thead\")\n    .attr(\"id\", \"month-head\");\n\n  thead\n    .selectAll(\"#month-head-year-row\")\n    .data([null])\n    .join(\"tr\")\n    .attr(\"id\", \"month-head-year-row\")\n    .style(\"text-align\", \"center\")\n    .selectAll(\"#month-year-cell\")\n    .data([monthDate])\n    .join(\"td\")\n    .attr(\"id\", \"month-year-cell\")\n    .attr(\"style\", \"font-size: 14px; box-sizing: border-box;\")\n    .attr(\"colspan\", 7)\n    .text((d) => `${d.monthLong}${showYear ? \" \" + d.year : \"\"}`);\n  thead\n    .selectAll(\".weekday-name-row\")\n    .data([null])\n    .join(\"tr\")\n    .attr(\"class\", \"weekday-name-row\")\n    .selectAll(\".weekday-name-cell\")\n    .data(dayNames)\n    .join(\"td\")\n    .attr(\"class\", \"weekday-name-cell\")\n    .attr(\n      \"style\",\n      \"font-size: 10px; text-align: center; box-sizing: border-box;\"\n    )\n    .text((d) => d);\n\n  const tbody = table\n    .selectAll(\"#calendar-body\")\n    .data([null])\n    .join(\"tbody\")\n    .attr(\"id\", \"calendar-body\");\n\n  const drawBar = (parent, idPrefix, dayAndAmount) => {\n    const svg = parent\n      .append(\"svg\")\n      .data([dayAndAmount], (d) => d.day)\n      .attr(\"id\", `${idPrefix}-svg`)\n      .attr(\"x\", \"0\")\n      .attr(\"y\", \"0\")\n      .attr(\"width\", `${tableSquareSizePx - 4}`) // TODO how do I get out of doing this math?  Without it, the year view jumps when the svg shifts cells.  I assume the math is incorporating the boarder, passing, etc.\n      .attr(\"height\", `${tableSquareSizePx - 4}`)\n      .attr(\"style\", \"text-align: center\");\n    svg\n      .append(\"rect\")\n      .data([dayAndAmount], (d) => d.day)\n      .attr(\"id\", `${idPrefix}-rect`)\n      .attr(\"class\", \"bar\")\n      .attr(\"fill\", \"black\")\n      .attr(\"x\", \"0\")\n      .attr(\"y\", (d) => yBar(d.amount))\n      .attr(\"width\", tableSquareSizePx - 4)\n      .attr(\"height\", (d) => {\n        const y0 = yBar(0);\n        const yamt = yBar(d.amount);\n        return y0 - yamt;\n      });\n    if (showAmountOnBar) {\n      svg\n        .append(\"text\")\n        .data([dayAndAmount], (d) => d.day)\n        .attr(\"id\", `${idPrefix}-text`)\n        .attr(\"x\", (tableSquareSizePx - 4) / 2)\n        .attr(\"y\", (d) => yBar(d.amount))\n        .attr(\"style\", \"font-size: large; pointer-events: none;\")\n        .attr(\"fill\", \"white\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"hanging\")\n        .text((d) => format(\"$,.0f\")(d.amount));\n    }\n  };\n\n  const updateBar = (parent, idPrefix) => {\n    parent\n      .select(`#${idPrefix}-text`)\n      .attr(\"y\", (d) => yBar(d.amount))\n      .text((d) => format(\"$,.0f\")(d.amount));\n    parent\n      .select(`#${idPrefix}-rect`)\n      .attr(\"y\", (d) => yBar(d.amount))\n      .attr(\"height\", (d) => {\n        const y0 = yBar(0);\n        const yamt = yBar(d.amount);\n        return y0 - yamt;\n      });\n  };\n\n  const drawWord = (parent, idPrefix, dayAndAmount) => {\n    parent\n      .append(\"div\")\n      .data([dayAndAmount], (d) => d)\n      .attr(\"id\", `${idPrefix}-div`)\n      .attr(\"class\", \"amount-div\")\n      .attr(\n        \"style\",\n        \"font-size:12px; position: absolute; top: 50%; left: 50%; transform: translateX(-50%) translateY(-50%); font-weight: bold;\"\n      )\n      .text(format(\"$,.0f\")(dayAndAmount.amount));\n  };\n\n  const updateWord = (parent, idPrefix) => {\n    const selection = parent.select(`#${idPrefix}-div`);\n    selection.text((d) => format(\"$,.0f\")(d.amount));\n  };\n\n  const drawIcon = (parent, idPrefix, dayAndAmount) => {\n    const g = parent\n      .append(\"svg\")\n      .data([dayAndAmount], (d) => d.day)\n      .attr(\"id\", `${idPrefix}-svg`)\n      .attr(\"x\", \"0\")\n      .attr(\"y\", \"0\")\n      .attr(\"width\", `${tableSquareSizePx - 4}`) // TODO how do I get out of doing this math?  Without it, the year view jumps when the svg shifts cells.  I assume the math is incorporating the boarder, passing, etc.\n      .attr(\"height\", `${tableSquareSizePx - 4}`)\n      .attr(\"style\", \"text-align: center\")\n      .append(\"g\")\n      .attr(\"transform\", `translate(${iconSize},${iconSize})`);\n    g.selectAll(`.${idPrefix}-icon`)\n      .data(iconAmtData, (d) => d)\n      .join(\n        (enter) => {\n          enter\n            .append(\"circle\")\n            .attr(\"class\", `${idPrefix}-circle`)\n            .attr(\"cx\", (d) => {\n              const iconIdx = amtToIconIdx(d);\n              const iconX = xIcon(iconIdx % numIconCol);\n              return iconX;\n            })\n            .attr(\"cy\", (d) => {\n              const iconIdx = amtToIconIdx(d);\n              const iconY = yIcon(Math.floor(iconIdx / numIconCol));\n              return iconY;\n            })\n            .attr(\"r\", iconSize)\n            .attr(\"fill\", (d) => {\n              const color = d < dayAndAmount.amount ? \"black\" : \"lightgrey\";\n              return color;\n            })\n            .attr(\n              \"style\",\n              (d) =>\n                `pointer-events: none; stroke: ${\n                  d < dayAndAmount.amount ? \"black\" : \"darkgrey\"\n                };`\n            );\n        },\n        (update) => {\n          update\n            .select(`.${idPrefix}-icon`)\n            .attr(\"fill\", (d) => {\n              const color = d < dayAndAmount.amount ? \"black\" : \"lightgrey\";\n              return color;\n            })\n            .attr(\n              \"style\",\n              (d) =>\n                `pointer-events: none; stroke: ${\n                  d < dayAndAmount.amount ? \"black\" : \"darkgrey\"\n                };`\n            );\n        },\n        (exit) => exit.remove()\n      );\n  };\n\n  // const drawHoverText = (parent, idPrefix, dayAndAmount) => {\n  //   parent\n  //     .append(\"span\")\n  //     .data([dayAndAmount], (d) => d.day)\n  //     .attr(\"id\", `${idPrefix}-span`)\n  //     .attr(\"class\", \"details-hover\")\n  //     .text(format(\"$,.0f\")(dayAndAmount.amount));\n  // };\n\n  // const updateHoverText = (parent, idPrefix) => {\n  //   const selection = parent.select(`#${idPrefix}-span`);\n  //   selection.text((d) => format(\"$,.0f\")(d.amount));\n  // };\n\n  tbody\n    .selectAll(\".day-rows\")\n    .data(monthDaysAmounts, (d) => d.day)\n    .join(\"tr\")\n    .attr(\"class\", \"day-rows\")\n    .selectAll(\".day-cells\")\n    .data(\n      (d) => d,\n      (d) => JSON.stringify(d)\n    )\n    .join(\n      (enter) => {\n        //const tooltip = d3.select(\".tooltip-area\").style(\"opacity\", 0);\n        enter\n          .append(\"td\")\n          .attr(\"class\", \"day-cells\")\n          .attr(\"id\", (d) =>\n            d.type === AmountType.earlierAmount\n              ? \"earlier-day\"\n              : d.type === AmountType.laterAmount\n              ? \"later-day\"\n              : null\n          )\n          .attr(\"width\", tableSquareSizePx)\n          .attr(\"height\", tableSquareSizePx)\n          .attr(\"style\", (d) =>\n            d.day > 0\n              ? //? \"border: 1px solid black; text-align: right; vertical-align: top; position: relative; overflow: hidden; white-space: nowrap;\"\n                `font-size: 1vw; background-color: ${\n                  d.type === AmountType.none ? \"lightgrey\" : \"lightgrey\"\n                }; border: ${\n                  d.type === AmountType.none\n                    ? \"2px solid white; \"\n                    : \"2px solid white; \"\n                } border-radius: 5px; text-align: right; vertical-align: top; position: relative; overflow: hidden; white-space: nowrap;`\n              : `border: none;`\n          )\n          .attr(\"title\", (d) =>\n            d.type === AmountType.none ? null : format(\"$,.0f\")(d.amount)\n          )\n          .on(\"click\", (d) => {\n            if (\n              q.interaction === InteractionType.titration ||\n              q.interaction === InteractionType.none\n            ) {\n              if (d.target.__data__.type === AmountType.earlierAmount) {\n                dispatchCallback(\n                  answer({\n                    choice: ChoiceType.earlier,\n                    choiceTimestamp: DateTime.local(),\n                  })\n                );\n              } else if (d.target.__data__.type === AmountType.laterAmount) {\n                dispatchCallback(\n                  answer({\n                    choice: ChoiceType.later,\n                    choiceTimestamp: DateTime.local(),\n                  })\n                );\n              }\n            }\n          })\n          // .on(\"mousemove\", () => {\n          //   tooltip.style(\"opacity\", 1);\n          // })\n          // .on(\"mouseleave\", () => {\n          //   tooltip.style(\"opacity\", 0);\n          // })\n          // .on(\"mouseover\", (event, d) => {\n          //   const text = d3.select(\".tooltip-area__text\");\n          //   text.text(format(\"$,.0f\")(d.amount));\n          //   const [x, y] = d3.pointer(event);\n          //   tooltip.attr(\"transform\", `translate(${x}, ${y - 20})`);\n          // })\n          .each(function (d) {\n            const td = select(this);\n            if (d.day >= 0) {\n              td.append(\"div\")\n                .attr(\"style\", \"font-size: 10px; float: right\")\n                .attr(\"class\", \"day-div\")\n                .text((d) => {\n                  if (d.day <= 0) return \"\";\n                  if (\n                    (d.day === 1 ||\n                      d.day === lastDayOfMonth ||\n                      firstDaysOfWeek.includes(d.day)) &&\n                    d.type === AmountType.none\n                  )\n                    return d.day;\n                });\n            }\n            if (\n              d.type === AmountType.earlierAmount ||\n              d.type === AmountType.laterAmount\n            ) {\n              // TODO this is a hack.  Must be a better way.\n              yBar = scaleLinear()\n                .domain(yRange)\n                .range([td.node().clientHeight, 0]);\n              yIcon = scaleBand()\n                .range([tableSquareSizePx - 4, 0])\n                .domain(d3.range(numIconRow));\n              xIcon = d3\n                .scaleBand()\n                .range([0, tableSquareSizePx - 4])\n                .domain(d3.range(numIconCol));\n\n              switch (q.viewType) {\n                case ViewType.calendarWord:\n                  drawWord(\n                    td,\n                    d.type === AmountType.earlierAmount ? \"earlier\" : \"later\",\n                    d\n                  );\n                  break;\n                case ViewType.calendarBar:\n                  drawBar(\n                    td,\n                    d.type === AmountType.earlierAmount ? \"earlier\" : \"later\",\n                    d\n                  );\n                  break;\n                case ViewType.calendarIcon:\n                  drawIcon(\n                    td,\n                    d.type === AmountType.earlierAmount ? \"earlier\" : \"later\",\n                    d\n                  );\n                  break;\n              }\n              // drawHoverText(\n              //   td,\n              //   d.type === AmountType.earlierAmount ? \"earlier\" : \"later\",\n              //   d\n              // );\n            }\n          });\n      },\n      (update) => {\n        switch (q.viewType) {\n          case ViewType.calendarBar:\n            updateBar(update, \"earlier\");\n            updateBar(update, \"later\");\n            // updateHoverText(update, \"earlier\");\n            // updateHoverText(update, \"later\");\n            break;\n          case ViewType.calendarWord:\n            updateWord(update, \"earlier\");\n            updateWord(update, \"later\");\n            // updateHoverText(update, \"earlier\");\n            // updateHoverText(update, \"later\");\n            break;\n          case ViewType.calendarIcon:\n            //updateIcon(update, \"earlier\", update.datum().amount);\n            //updateIcon(update, \"later\", update.datum().amount);\n            break;\n        }\n      },\n      (exit) => exit.remove()\n    );\n  if (q.interaction === InteractionType.drag) {\n    var dragHandler = drag().on(\"drag\", function (d) {\n      if (d.subject.type === q.variableAmount) {\n        const newAmount = yBar.invert(d.y);\n        if (newAmount > q.maxAmount) return;\n        d.subject.amount = newAmount;\n        select(this)\n          .attr(\"y\", d.y)\n          .attr(\"height\", yBar(0) - d.y);\n        dragCallback(d.subject);\n        d3.select(\n          `#${d.type === AmountType.earlierAmount ? \"earlier\" : \"later\"}-text`\n        )\n          .attr(\"y\", (d) => yBar(d.amount))\n          .text(() => format(\"$,.0f\")(d.subject.amount));\n      }\n    });\n    dragHandler(table.selectAll(\".bar\"));\n  }\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport { Formik, Form } from \"formik\";\nimport { Button } from \"react-bootstrap\";\nimport { DateTime } from \"luxon\";\nimport {\n  selectCurrentQuestion,\n  fetchStatus,\n  setQuestionShownTimestamp,\n  answer,\n} from \"../features/questionSlice\";\nimport { useD3 } from \"../hooks/useD3\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { StatusType } from \"../features/StatusType\";\nimport { InteractionType } from \"../features/InteractionType\";\nimport { drawCalendar } from \"./CalendarHelper\";\n\nfunction Calendar() {\n  const dispatch = useDispatch();\n  const q = useSelector(selectCurrentQuestion);\n  const status = useSelector(fetchStatus);\n\n  var dragAmount = null;\n\n  const result = (\n    <div>\n      <table\n        id=\"calendar\"\n        style={{ borderCollapse: \"collapse\", tableLayout: \"fixed\" }}\n        ref={useD3(\n          (table) => {\n            drawCalendar({\n              table: table,\n              question: q,\n              monthDate: q.dateEarlier,\n              tableWidthIn: q.widthIn,\n              showYear: true,\n              showAmountOnBar: true,\n              numIconCol: 10,\n              numIconRow: 10,\n              iconSize: 3,\n              dragCallback: (amount) => {\n                dragAmount = amount;\n              },\n              dispatchCallback: (answer) => {\n                dispatch(answer);\n              },\n            });\n          },\n          [q]\n        )}\n      ></table>\n      {q.interaction === InteractionType.drag ? (\n        <Formik\n          initialValues={{ choice: ChoiceType.Unitialized }}\n          validate={() => {\n            let errors = {};\n            return errors;\n          }}\n          onSubmit={(values, { setSubmitting, resetForm }) => {\n            setTimeout(() => {\n              dispatch(\n                answer({\n                  choice: q.variableAmount,\n                  choiceTimestamp: DateTime.local(),\n                  dragAmount: dragAmount.amount,\n                })\n              );\n              setSubmitting(false);\n              resetForm();\n            }, 400);\n          }}\n        >\n          {({ isSubmitting }) => (\n            <Form>\n              <Button type=\"submit\" disabled={isSubmitting}>\n                Submit\n              </Button>\n            </Form>\n          )}\n        </Formik>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n\n  if (status === StatusType.Complete) {\n    return <Redirect to=\"/vizsurvey/post-survey\" />;\n  } else {\n    dispatch(setQuestionShownTimestamp(Date.now()));\n    return result;\n  }\n}\n\nexport default Calendar;\n","/* eslint-disable no-unused-vars */\nimport React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport { select } from \"d3\";\nimport * as d3 from \"d3\";\nimport { Formik, Form } from \"formik\";\nimport { Button } from \"react-bootstrap\";\nimport { DateTime } from \"luxon\";\nimport {\n  selectCurrentQuestion,\n  fetchStatus,\n  setQuestionShownTimestamp,\n  answer,\n} from \"../features/questionSlice\";\nimport { useD3 } from \"../hooks/useD3\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { StatusType } from \"../features/StatusType\";\nimport { InteractionType } from \"../features/InteractionType\";\nimport { drawCalendar } from \"./CalendarHelper\";\n\nfunction Calendar() {\n  const dispatch = useDispatch();\n  const q = useSelector(selectCurrentQuestion);\n  const status = useSelector(fetchStatus);\n\n  const monthsMatrix = [\n    [\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 1, 1),\n        hasEarlierDate: q.dateEarlier.month === 1,\n        hasLaterDate: q.dateLater.month === 1,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 2, 1),\n        hasEarlierDate: q.dateEarlier.month === 2,\n        hasLaterDate: q.dateLater.month === 2,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 3, 1),\n        hasEarlierDate: q.dateEarlier.month === 3,\n        hasLaterDate: q.dateLater.month === 3,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 4, 1),\n        hasEarlierDate: q.dateEarlier.month === 4,\n        hasLaterDate: q.dateLater.month === 4,\n      },\n    ],\n    [\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 5, 1),\n        hasEarlierDate: q.dateEarlier.month === 5,\n        hasLaterDate: q.dateLater.month === 5,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 6, 1),\n        hasEarlierDate: q.dateEarlier.month === 6,\n        hasLaterDate: q.dateLater.month === 6,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 7, 1),\n        hasEarlierDate: q.dateEarlier.month === 7,\n        hasLaterDate: q.dateLater.month === 7,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 8, 1),\n        hasEarlierDate: q.dateEarlier.month === 8,\n        hasLaterDate: q.dateLater.month === 8,\n      },\n    ],\n    [\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 9, 1),\n        hasEarlierDate: q.dateEarlier.month === 9,\n        hasLaterDate: q.dateLater.month === 9,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 10, 1),\n        hasEarlierDate: q.dateEarlier.month === 10,\n        hasLaterDate: q.dateLater.month === 10,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 11, 1),\n        hasEarlierDate: q.dateEarlier.month === 11,\n        hasLaterDate: q.dateLater.month === 11,\n      },\n      {\n        firstOfMonth: DateTime.local(q.dateEarlier.year, 12, 1),\n        hasEarlierDate: q.dateEarlier.month === 12,\n        hasLaterDate: q.dateLater.month === 12,\n      },\n    ],\n  ];\n\n  const dpi = window.devicePixelRatio >= 2 ? 132 : 96;\n  const noAmountMonthCellSizeIng = 0.1875; // width and height is 34px without\n  // TODO this will always be constrained by q.heightIn since the monitor aspect ration is shorter in height.  Unessarily complex to consider q.widthIn in calculation\n  const monthTdSquareSizeIn = Math.min(q.heightIn / 3, q.widthIn / 4);\n  const monthTdSquareSizePx = Math.round(monthTdSquareSizeIn * dpi);\n  // I gave up on trying to shrink the months that don't have amounts for now.  Left the code in place to try to fix later.\n  //const monthTdSquareSizePxNoAmount = monthTdSquareSizePx;\n  //const monthTdSquareSizePxAmount = monthTdSquareSizePx;\n\n  var dragAmount = null;\n\n  const result = (\n    <div>\n      <table\n        id=\"year-calendar\"\n        style={{ borderCollapse: \"collapse\", tableLayout: \"fixed\" }}\n        ref={useD3(\n          (table) => {\n            const yearTable = d3\n              .select(\"#year-calendar\")\n              .data([null])\n              .join(\"table\");\n            const yearHead = yearTable\n              .selectAll(\"#year-head\")\n              .data([null])\n              .join(\"thead\")\n              .attr(\"id\", \"year-head\");\n            yearHead\n              .selectAll(\"#year-head-row\")\n              .data([null])\n              .join(\"tr\")\n              .attr(\"id\", \"year-head-row\")\n              .style(\"text-align\", \"center\")\n              .selectAll(\"#year-cell\")\n              .data([q.dateEarlier])\n              .join(\"td\")\n              .attr(\"id\", \"year-cell\")\n              .attr(\"style\", \"font-size: 14px;\")\n              .attr(\"colspan\", 7)\n              .text((d) => d.year);\n            const yearBody = yearTable\n              .selectAll(\"#year-calendar-body\")\n              .data([null])\n              .join(\"tbody\")\n              .attr(\"id\", \"year-calendar-body\");\n            yearBody\n              .selectAll(\".months-rows\")\n              .data(monthsMatrix)\n              .join(\"tr\")\n              .attr(\"class\", \"months-rows\")\n              .selectAll(\".months-cells\")\n              .data(\n                (d) => d,\n                (d) => d\n              )\n              .join(\"td\")\n              .attr(\"class\", \"months-cells\")\n              .attr(\n                \"width\",\n                (d) => monthTdSquareSizePx\n                // d.hasEarlierDate || d.hasLaterDate\n                //</div>   ? monthTdSquareSizePxAmount\n                //   : monthTdSquareSizePxNoAmount\n              )\n              .attr(\n                \"height\",\n                (d) => monthTdSquareSizePx\n                //d.hasEarlierDate || d.hasLaterDate\n                //</div>  ? monthTdSquareSizePxAmount\n                //  : monthTdSquareSizePxNoAmount\n              )\n              .attr(\"style\", \"vertical-align: top;\")\n              .each(function (monthDate) {\n                const yearTd = select(this);\n                drawCalendar({\n                  table: yearTd,\n                  question: q,\n                  monthDate: monthDate.firstOfMonth,\n                  tableWidthIn: monthTdSquareSizeIn,\n                  showYear: false,\n                  showAmountOnBar: false,\n                  numIconCol: 5,\n                  numIconRow: 5,\n                  iconSize: 3,\n                  dragCallback: (amount) => {\n                    dragAmount = amount;\n                  },\n                  dispatchCallback: (answer) => {\n                    dispatch(answer);\n                  },\n                });\n              });\n          },\n          [q]\n        )}\n      ></table>\n      {q.interaction === InteractionType.drag ? (\n        <Formik\n          initialValues={{ choice: ChoiceType.Unitialized }}\n          validate={() => {\n            let errors = {};\n            return errors;\n          }}\n          onSubmit={(values, { setSubmitting, resetForm }) => {\n            setTimeout(() => {\n              dispatch(\n                answer({\n                  choice: ChoiceType.earlier,\n                  choiceTimestamp: DateTime.local(),\n                })\n              );\n              setSubmitting(false);\n              resetForm();\n            }, 400);\n          }}\n        >\n          {({ isSubmitting }) => (\n            <Form>\n              <Button type=\"submit\" disabled={isSubmitting}>\n                Submit\n              </Button>\n            </Form>\n          )}\n        </Formik>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n\n  if (status === StatusType.Complete) {\n    return <Redirect to=\"/vizsurvey/thankyou\" />;\n  } else {\n    dispatch(setQuestionShownTimestamp(Date.now()));\n    return result;\n  }\n}\n\nexport default Calendar;\n","/* eslint-disable no-unused-vars */\nimport MELForm from \"./MELForm\";\nimport BarChart from \"./BarChart\";\nimport Calendar from \"./Calendar\";\nimport CalendarYear from \"./CalendarYear\";\nimport { useSelector } from \"react-redux\";\nimport { ViewType } from \"../features/ViewType\";\nimport { selectCurrentQuestion } from \"../features/questionSlice\";\n\nexport function Survey() {\n  const question = useSelector(selectCurrentQuestion);\n\n  // Got from https://stackoverflow.com/questions/31217268/center-div-on-the-middle-of-screen\n  const divCenterContentStyle = {\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    marginRight: \"-50%\",\n    transform: \"translate(-50%, -50%)\",\n  };\n\n  const monthsApart = question.dateLater\n    ? question.dateLater.diff(question.dateEarlier, \"months\").toObject().months\n    : null;\n\n  return (\n    <div style={divCenterContentStyle}>\n      {(() => {\n        switch (question.viewType) {\n          case ViewType.barchart:\n            return <BarChart />;\n          case ViewType.word:\n            return <MELForm />;\n          case ViewType.calendarBar:\n          case ViewType.calendarIcon:\n          case ViewType.calendarWord:\n            if (monthsApart <= 1) {\n              return <Calendar />;\n            }\n            return <CalendarYear />;\n        }\n      })()}\n    </div>\n  );\n}\n\nexport default Survey;\n","export const POST_SURVEY_QUESTIONS = [\n  {\n    question: {\n      textFull:\n        \"Suppose a 15 year mortgage and a 30 year mortgage have the same Annual Percentage Rate and the same amount borrowed. The total amount repaid will be:\",\n      textShort: \"15vs30\",\n    },\n    options: [\n      {\n        textFull: \"Higher for the 15 year mortgage\",\n        textShort: \"15+\",\n      },\n      {\n        textFull: \"Higher for the 30 year mortgage\",\n        textShort: \"30+\",\n      },\n      {\n        textFull: \"The total amount repaid will be the same\",\n        textShort: \"15=30\",\n      },\n    ],\n  },\n  {\n    question: {\n      textFull:\n        \"Suppose you owe $50,000 on a mortgage at an Annual Percentage Rate of 6%. If you didn’t make any payments on this mortgage how much would you owe in total after one year?\",\n      textShort: \"50k6p\",\n    },\n    options: [\n      {\n        textFull: \"Less than $50,000\",\n        textShort: \"<50k\",\n      },\n      {\n        textFull: \"$50,000 – $54,999\",\n        textShort: \"50kto55k\",\n      },\n      {\n        textFull: \"$55,000 – $59,999\",\n        textShort: \"55kto60k\",\n      },\n      {\n        textFull: \"$60,000 – $64,999\",\n        textShort: \"60kto65k\",\n      },\n      {\n        textFull: \"More than $65,000\",\n        textShort: \"65k+\",\n      },\n    ],\n  },\n  {\n    question: {\n      textFull:\n        \"Suppose you owe $100,000 on a mortgage at an Annual Percentage Rate of 5%. If you didn’t make any payments on this mortgage how much would you owe in total after five years?\",\n      textShort: \"100k5p\",\n    },\n    options: [\n      {\n        textFull: \"Less than $120,000\",\n        textShort: \"<120k\",\n      },\n      {\n        textFull: \"Between $120,000 and $125,000\",\n        textShort: \"120kto125k\",\n      },\n      {\n        textFull: \"More than $125,000\",\n        textShort: \"125k+\",\n      },\n    ],\n  },\n  {\n    question: {\n      textFull:\n        \"Suppose you owe $200,000 on a mortgage with at an Annual Percentage Rate of 5%. If you made annual payments of $10,000 per year how long would it take to repay the whole mortgage?\",\n      textShort: \"200k5p\",\n    },\n    options: [\n      {\n        textFull: \"Less than 20 years\",\n        textShort: \"<20y\",\n      },\n      {\n        textFull: \"Between 20 and 30 years\",\n        textShort: \"20yto30y\",\n      },\n      {\n        textFull: \"Between 30 and 40 years\",\n        textShort: \"30yto40y\",\n      },\n      {\n        textFull: \"The mortgage would never be repaid\",\n        textShort: \"never\",\n      },\n    ],\n  },\n];\n","import { Button } from \"react-bootstrap\";\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\nimport { ChoiceType } from \"../features/ChoiceType\";\nimport { POST_SURVEY_QUESTIONS } from \"../features/postsurveyquestions\";\nimport { useHistory } from \"react-router-dom\";\n\nconst divCenterContentStyle1 = {\n  position: \"absolute\",\n  left: \"50%\",\n  width: \"500px\",\n  marginRight: \"-50%\",\n  transform: \"translate(-50%, 0%)\",\n};\n\nexport function PostSurvey() {\n  //const dispatch = useDispatch();\n\n  const history = useHistory();\n  const routeChange = () => {\n    let path = `/vizsurvey/thankyou`;\n    history.push(path);\n  };\n\n  const questions = POST_SURVEY_QUESTIONS;\n  return (\n    <div id=\"home-text\" style={divCenterContentStyle1}>\n      <Formik\n        initialValues={questions.reduce((result, currentObj) => {\n          result[\"choice\" + currentObj.question.textShort] =\n            ChoiceType.unitialized;\n          return result;\n        }, {})}\n        validate={(values) => {\n          return questions.reduce((errors, currentObj) => {\n            const key = \"choice\" + currentObj.question.textShort;\n            if (!values[key] || values[key] === ChoiceType.unitialized) {\n              errors[key] = \"Please choose a selection to continue.\";\n            }\n            return errors;\n          }, {});\n        }}\n        onSubmit={(values, { setSubmitting, resetForm }) => {\n          setTimeout(() => {\n            console.log(values);\n            /*dispatch(\n              answer({\n                choice: values.choice,\n                choiceTimestamp: DateTime.local(),\n              })\n            );*/\n            setSubmitting(false);\n            resetForm();\n            routeChange();\n          }, 400);\n        }}\n      >\n        {({ isSubmitting }) => (\n          <Form>\n            {questions.map(({ question, options }, index) => (\n              <div key={index}>\n                <div\n                  role={\"group\" + index}\n                  aria-labelledby={\"my-radio-group\" + index}\n                  className=\"radio-choice-label\"\n                >\n                  <p>{index + 1 + \". \" + question.textFull}</p>\n                  {options.map((option, index1) => (\n                    <div key={index1}>\n                      <label>\n                        <Field\n                          type=\"radio\"\n                          name={\"choice\" + question.textShort}\n                          value={\"value\" + option.textShort}\n                        />\n                        &nbsp;{option.textFull}\n                      </label>\n                      <br />\n                    </div>\n                  ))}\n                  <label>\n                    <Field\n                      type=\"radio\"\n                      name={\"choice\" + question.textShort}\n                      value=\"unsure\"\n                    />\n                    &nbsp;Do not know\n                  </label>\n                  <span style={{ color: \"red\", fontWeight: \"bold\" }}>\n                    <ErrorMessage\n                      name={\"choice\" + question.textShort}\n                      component=\"div\"\n                    />\n                  </span>\n                </div>\n                <br />\n                <div className=\"post-survey-separator\"></div>\n                <br />\n              </div>\n            ))}\n            <Button type=\"submit\" disabled={isSubmitting}>\n              Submit\n            </Button>\n            <br />\n            <br />\n          </Form>\n        )}\n      </Formik>\n    </div>\n  );\n}\n\nexport default PostSurvey;\n","import { useDispatch } from \"react-redux\";\nimport { useLocation } from \"react-router-dom\";\nimport { setTreatmentId } from \"../features/questionSlice\";\n\nexport function QueryParam() {\n  const dispatch = useDispatch();\n  const search = useLocation().search;\n  const treatmentId = new URLSearchParams(search).get(\"treatment_id\");\n  dispatch(setTreatmentId(treatmentId));\n  return \"\";\n}\n\nexport default QueryParam;\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { BrowserRouter, Route, Switch, Link, Redirect } from \"react-router-dom\";\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { Button } from \"react-bootstrap\";\nimport \"./App.css\";\nimport Survey from \"./components/Survey\";\nimport PostSurvey from \"./components/PostSurvey\";\nimport { QueryParam } from \"./components/QueryParam\";\nimport {\n  fetchQuestions,\n  loadAllTreatments,\n  fetchAllTreatmentsStatus,\n  fetchAllTreatments,\n  selectAllQuestions,\n  startSurvey,\n  writeAnswers,\n  setParticipant,\n} from \"./features/questionSlice\";\nimport { ViewType } from \"./features/ViewType\";\nimport { InteractionType } from \"./features/InteractionType\";\nimport { FileIOAdapter } from \"./features/FileIOAdapter\";\nimport {\n  fetchTreatmentId,\n  fetchCurrentTreatment,\n} from \"./features/questionSlice\";\nimport { StatusType } from \"./features/StatusType\";\n\nconst App = () => {\n  return (\n    <div>\n      <BrowserRouter>\n        <div className=\"App\">\n          <QueryParam />\n          <Switch>\n            <Route exact path=\"/vizsurvey\" component={Home} />\n            <Route\n              exact\n              path={\"/vizsurvey/instructions\"}\n              component={Instructions}\n            />\n            <Route path=\"/vizsurvey/survey\" component={Survey} />\n            <Route path=\"/vizsurvey/post-survey\" component={PostSurvey} />\n            <Route path=\"/vizsurvey/thankyou\" component={ThankYou} />\n            <Route path=\"/vizsurvey/*\" component={Home} />\n          </Switch>\n        </div>\n      </BrowserRouter>\n    </div>\n  );\n};\n\nexport default App;\n\nconst Home = () => {\n  const treatmentId = useSelector(fetchTreatmentId);\n  const dispatch = useDispatch();\n  dispatch(loadAllTreatments());\n  const status = useSelector(fetchAllTreatmentsStatus);\n  const allTreatments = useSelector(fetchAllTreatments);\n\n  function testLinks() {\n    return (\n      <div>\n        <p>\n          This page will not be available when deployed in production since the\n          participants will be provided a link with the treatment id in the URL.\n        </p>\n        {status === StatusType.Unitialized ? (\n          <p>Please wait while all treatments are loaded...</p>\n        ) : (\n          <p>\n            <a href=\"https://github.com/pcordone/vizsurvey\">Github README.md</a>\n            <br></br>\n            <a href=\"https://github.com/pcordone\">public website</a>\n            <br></br>\n            <p>\n              Click a link below to launch one of the experiments. The\n              experimental parameters are not setup yet and are configurable\n              through a file. Right now these links give a feel for what each\n              type of stimulus is like.\n            </p>\n            <p>\n              <Link id=\"1\" to=\"/vizsurvey/instructions?treatment_id=1\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 1 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"2\" to=\"/vizsurvey/instructions?treatment_id=2\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 2 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"3\" to=\"/vizsurvey/instructions?treatment_id=3\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 3 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"4\" to=\"/vizsurvey/instructions?treatment_id=4\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 4 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"5\" to=\"/vizsurvey/instructions?treatment_id=5\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 5 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"6\" to=\"/vizsurvey/instructions?treatment_id=6\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 6 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"7\" to=\"/vizsurvey/instructions?treatment_id=7\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 7 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"8\" to=\"/vizsurvey/instructions?treatment_id=8\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 8 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"9\" to=\"/vizsurvey/instructions?treatment_id=9\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 9 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"10\" to=\"/vizsurvey/instructions?treatment_id=10\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 10 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"11\" to=\"/vizsurvey/instructions?treatment_id=11\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 11 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"12\" to=\"/vizsurvey/instructions?treatment_id=12\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 12 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"13\" to=\"/vizsurvey/instructions?treatment_id=13\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 13 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"14\" to=\"/vizsurvey/instructions?treatment_id=14\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 14 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"15\" to=\"/vizsurvey/instructions?treatment_id=15\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 15 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"16\" to=\"/vizsurvey/instructions?treatment_id=16\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 16 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"17\" to=\"/vizsurvey/instructions?treatment_id=17\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 17 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n            <p>\n              <Link id=\"18\" to=\"/vizsurvey/instructions?treatment_id=18\">\n                {\n                  allTreatments.filter(\n                    (d) => d.treatmentId === 18 && d.position === 1\n                  )[0].comment\n                }\n              </Link>\n            </p>\n          </p>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div id=\"home-text\">\n      {treatmentId === null ? (\n        testLinks()\n      ) : (\n        <Redirect to={`/vizsurvey/instructions?treatment_id=${treatmentId}`} />\n      )}\n    </div>\n  );\n};\n\nconst divCenterContentStyle = {\n  position: \"absolute\",\n  top: \"50%\",\n  left: \"50%\",\n  width: \"500px\",\n  marginRight: \"-50%\",\n  transform: \"translate(-50%, -50%)\",\n};\n\nconst buttonCenterContentStyle = {\n  position: \"absolute\",\n  left: \"50%\",\n  marginRight: \"-50%\",\n  transform: \"translate(-50%, 0%)\",\n};\n\nconst Instructions = () => {\n  var handle = useFullScreenHandle();\n  const dispatch = useDispatch();\n  dispatch(fetchQuestions());\n  const treatment = useSelector(fetchCurrentTreatment);\n\n  function surveyButtonClicked() {\n    dispatch(startSurvey());\n    handle.enter();\n  }\n\n  return (\n    <div id=\"home-text\" style={divCenterContentStyle}>\n      <p>\n        You will be presented with a choice between two amounts of money to\n        recieve, one earlier and one later in time.\n      </p>\n      <span>\n        {(() => {\n          switch (treatment.viewType) {\n            case ViewType.word:\n              return `Click on the radio button that contains the amount you would like to\n                    receive.`;\n            case ViewType.barchart:\n              switch (treatment.interaction) {\n                case InteractionType.titration:\n                  return `Click on the bar that represents the amount that you would like to\n                        receive.  For each click, the amounts will be updated. Continue to\n                        click to choose an earlier and later amount.`;\n                case InteractionType.drag:\n                  return `Drag the bar to an amount that makes choosing the earlier option\n                        equal to the later option. Note that these amounts do not have to\n                        be literally equal dollar amounts (e.g. you would rather have $10\n                        today than even $20 a year from now).`;\n                case InteractionType.none:\n                  return `Click on the bar graph that represents the amount that you would\n                        like to choose.`;\n                default:\n                  return `Can not display <b>specific</b> instructions since the interaction \n                        type was not specified in the experiment setup/`;\n              }\n            case ViewType.calendarBar:\n              return `Click on the day that contains the amount that you would like to\n                    receive.`;\n            case ViewType.calendarWord:\n              return `Provide calendar word instructions`;\n            case ViewType.calendarIcon:\n              return `Provide calendar icon grap instructions`;\n            default:\n              return `Cannot display <b>specific</b> instructions since a treatment has not\n                    been selected. Please select a treatment`;\n          }\n        })()}\n      </span>\n      <FullScreen handle={handle}>\n        <Link to=\"/vizsurvey/survey\">\n          <Button\n            size=\"lg\"\n            onClick={surveyButtonClicked}\n            style={buttonCenterContentStyle}\n          >\n            Start Survey\n          </Button>\n        </Link>\n      </FullScreen>\n    </div>\n  );\n};\n\nconst uuid = uuidv4();\nconst ThankYou = () => {\n  const dispatch = useDispatch();\n  dispatch(setParticipant(uuid));\n  const answers = useSelector(selectAllQuestions);\n  const io = new FileIOAdapter();\n  const csv = io.convertToCSV(answers);\n  dispatch(writeAnswers(csv));\n  const handle = useFullScreenHandle();\n\n  return (\n    <FullScreen handle={handle}>\n      <div id=\"home-text\" style={divCenterContentStyle}>\n        <p>\n          Your answers have been submitted. Thank you for taking this survey!\n        </p>\n        <p>\n          Your unique ID is:&nbsp;\n          <input type=\"text\" value={uuid} style={{ width: \"340px\" }} readOnly />\n          &nbsp;\n          <Button\n            size=\"sm\"\n            onClick={() => {\n              navigator.clipboard.writeText(uuid);\n            }}\n          >\n            Copy\n          </Button>\n          . Please go back to Amazon Turk and present this unique ID in the\n          form.\n        </p>\n        <Button\n          size=\"lg\"\n          onClick={() => {\n            handle.enter();\n            setTimeout(() => {\n              handle.exit();\n            }, 400);\n          }}\n          style={buttonCenterContentStyle}\n        >\n          Exit Fullscreen\n        </Button>\n      </div>\n    </FullScreen>\n  );\n};\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { enableAllPlugins } from \"immer\";\n\nimport { Provider } from \"react-redux\";\nimport { store } from \"./app/store\";\n\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nenableAllPlugins();\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}