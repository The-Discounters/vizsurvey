(this.webpackJsonpvizsurvey=this.webpackJsonpvizsurvey||[]).push([[0],{120:function(t){t.exports=JSON.parse('{"a":"1.0.1"}')},234:function(t,e){},235:function(t,e,n){},236:function(t,e,n){},247:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(34),c=n.n(i),o=n(10),s=n(50),u=n(1),l=n.n(u),d=n(4),b=n(17),j=n(26),m=n(27),_=n(14),h=n(123),p=n(88),f=n(111),O=atob(Object({NODE_ENV:"production",PUBLIC_URL:"/vizsurvey",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AUTH_TOKEN),v=Object({NODE_ENV:"production",PUBLIC_URL:"/vizsurvey",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GIST_ANSWER_ID,x=Object({NODE_ENV:"production",PUBLIC_URL:"/vizsurvey",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GIST_QUESTION_URL,g="Unitialized",y="Earlier",S="Later",w="Unitialized",T="Fetching",E="Fetched",A="Complete",q="Error",D=function(t){Object(j.a)(n,t);var e=Object(m.a)(n);function n(){return Object(b.a)(this,n),e.apply(this,arguments)}return n}(f.Enumify);D.word=new D,D.barchart=new D,D.calendar=new D,D._=D.closeEnum();var R=Object(s.b)("survey/getQuestions",function(){var t=Object(d.a)(l.a.mark((function t(e){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=+e,t.next=3,Object(_.c)(x);case 3:return(n=t.sent).forEach((function(t){t.view_type=D.enumValueOf(t.view_type),t.question_set_id=+t.question_set_id,t.position=+t.position,t.amount_earlier=+t.amount_earlier,t.time_earlier&&(t.time_earlier=+t.time_earlier),t.date_earlier&&(t.date_earlier=new Date(t.date_earlier)),t.amount_later=+t.amount_later,t.time_later&&(t.time_later=+t.time_later),t.date_later&&(t.date_later=new Date(t.date_later)),t.max_amount=+t.max_amount,t.max_time=+t.max_time,t.horizontal_pixels=+t.horizontal_pixels,t.vertical_pixels=+t.vertical_pixels,t.choice=g,t.answer_time=void 0,t.participant_id=void 0})),a=n.filter((function(t){return t.question_set_id===e})),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),C=Object(s.b)("survey/writeAnswers",function(){var t=Object(d.a)(l.a.mark((function t(e,n){var a,r,i,c,o,s,u,d,b,j;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.getState,r=a(),i=new h.a({userAgent:"thesis_answers/v1.0",auth:O}),c="PATCH /gists/".concat(v),o=p.DateTime.now().toFormat("yyyy-MM-dd-H-mm-ss-SSS-ZZZZ"),s={},e="".concat(e),s["answers-subject-".concat(r.questions.participant_id,"-").concat(o,".csv")]={content:e},u="Answer results for participant ".concat(r.questions.participant_id," at ").concat(o),console.log("submitting answers for "+u),d={gist_id:v,description:u,files:s},t.next=13,i.request(c,d);case 13:b=t.sent,j=b.status,console.log("answers submitted with status of "+j);case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),P=Object(s.c)({name:"questions",initialState:{questions:[],currentQuestion:0,question_set_id:null,participant_id:null,status:"Unitialized",error:null},reducers:{setParticipant:function(t,e){null===t.participant_id&&null!==e.payload&&(t.participant_id=e.payload)},setQuestionSet:function(t,e){null===t.questionSetId&&null!==e.payload&&(t.question_set_id=e.payload)},answer:function(t,e){t.questions[t.currentQuestion].choice=e.payload,t.questions[t.currentQuestion].answer_time=p.DateTime.now().toFormat("MM/dd/yyyy H:mm:ss:SSS ZZZZ"),t.questions[t.currentQuestion].participant_id=t.participant_id,t.currentQuestion===t.questions.length-1?t.status=A:t.currentQuestion+=1},nextQuestion:function(t){t.questions.currentQuestion+=t.currentQuestion<t.questions.length?1:0},previousQuestion:function(t){t.currentQuestion-=t.currentQuestion>0?1:0}},extraReducers:function(t){t.addCase(R.pending,(function(t){t.status===w&&(t.status=T)})).addCase(R.fulfilled,(function(t,e){t.questions=e.payload,t.currentQuestion=0,t.status=E})).addCase(R.rejected,(function(t,e){t.status===E&&(t.status=q,t.error=e.error)}))}}),k=function(t){return t.questions.questions},Q=function(t){return t.questions.questions[t.questions.currentQuestion]},I=function(t){return t.questions.status},F=P.actions,N=F.answer,z=(F.nextQuestion,F.previousQuestion,F.setParticipant),L=F.setQuestionSet,U=P.reducer,H=Object(s.a)({reducer:{questions:U}}),M=(n(235),n(40)),W=n(11),K=n(255),B=n(256),V=(n(236),n(252)),Z=n(253),J=n(254),G=n(51),$=n(251),Y=n(2);var X=function(){var t=Object(o.b)(),e=Object(o.c)(Q),n=Object(o.c)(I);function a(){return"$".concat(e.amount_earlier," ").concat(0===(t=e.time_earlier)?"today":"in ".concat(t," weeks"));var t}var r=Object(Y.jsx)(G.d,{initialValues:{choice:g},validate:function(t){var e={};return t.choice&&t.choice!==g||(e.choice="Please choose a selection to continue."),e},onSubmit:function(e,n){var a=n.setSubmitting,r=n.resetForm;setTimeout((function(){t(N(e.choice)),a(!1),r()}),400)},children:function(t){var n=t.isSubmitting;return Object(Y.jsxs)(G.c,{children:[Object(Y.jsxs)("div",{role:"group","aria-labelledby":"my-radio-group",className:"radio-choice-label",children:[Object(Y.jsxs)("label",{children:[Object(Y.jsx)(G.b,{type:"radio",name:"choice",value:y}),"\xa0",a()]}),Object(Y.jsx)("br",{}),Object(Y.jsxs)("label",{children:[Object(Y.jsx)(G.b,{type:"radio",name:"choice",value:S}),"\xa0","$".concat(e.amount_later," in ").concat(e.time_later," weeks")]}),Object(Y.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:Object(Y.jsx)(G.a,{name:"choice",component:"div"})})]}),Object(Y.jsx)($.a,{type:"submit",disabled:n,children:"Submit"})]})}});return n===A?Object(Y.jsx)(W.a,{to:"/thankyou"}):r},tt=function(t,e){var n=r.a.useRef();return r.a.useEffect((function(){return t(_.h(n.current)),function(){}}),e),n};var et=function(t){var e=Object(o.b)(),n=Object(o.c)(Q),a=Object(o.c)(I),r=n.vertical_pixels,i=n.horizontal_pixels,c={top:t.top_margin,right:t.right_margin,bottom:t.bottom_margin,left:t.left_margin},s={height:r+parseInt(c.top)+parseInt(c.bottom),width:i+parseInt(c.left)+parseInt(c.right),marginLeft:c.left+"px",marginRight:c.right+"px"},u=Array.from(Array(n.max_time+1).keys()),l=u.map((function(t){return t==n.time_earlier?{time:t,amount:n.amount_earlier}:t==n.time_later?{time:t,amount:n.amount_later}:{time:t,amount:0}})),d=Object(Y.jsx)("svg",{ref:tt((function(t){var a=t.selectAll(".plot-area").data([null]).join("g").attr("class","plot-area").attr("transform","translate(".concat(c.left,",").concat(c.top,")")),o=Object(_.g)().domain([0,n.max_time]).range([0,i]),s=[0,n.max_amount],d=Object(_.g)().domain(s).range([r,0]);a.selectAll(".x-axis").data([null]).join("g").attr("transform","translate(0,".concat(r,")")).attr("class","x-axis").call(Object(_.a)(o).tickValues(u).tickFormat(_.d(",.0f")));var b=Object(_.f)(s[0],s[1],s[1]/5);b.push(s[1]),a.selectAll(".y-axis").data([null]).join("g").attr("class","y-axis").call(Object(_.b)(d).tickValues(b).tickFormat(_.d("$,.0f"))),a.selectAll(".bar").data(l).join("rect").attr("fill","steelblue").attr("class","bar").attr("x",(function(t){return o(t.time)-7.5})).attr("width",15).attr("y",(function(t){return d(t.amount)})).on("click",(function(t){t.target.__data__.amount===n.amount_earlier?e(N(y)):e(N(S))})).attr("height",(function(t){return d(0)-d(t.amount)}))}),[l]),style:s});return a===A?Object(Y.jsx)(W.a,{to:"/thankyou"}):d},nt=n(241);var at=function(t){var e=Object(o.c)(Q),n=e.vertical_pixels,a=e.horizontal_pixels,r={top:t.top_margin,right:t.right_margin,bottom:t.bottom_margin,left:t.left_margin},i={height:n+parseInt(r.top)+parseInt(r.bottom),width:a+parseInt(r.left)+parseInt(r.right),marginLeft:r.left+"px",marginRight:r.right+"px"};return Object(Y.jsx)("table",{id:"calendar",ref:tt((function(t){var n=nt(e.date_earlier),a=["January","February","March","April","May","June","July","August","September","October","November","December"][e.date_earlier.getMonth()];t.html("<thead>\n                <tr>\n                    <td span='7'>\n                        <h2 id='currentMonth'></h2>\n                    </td>\n                </tr>\n                <tr>\n                    <td style='text-align: center;'>Sunday</td>\n                    <td style='text-align: center;'>Monday</td>\n                    <td style='text-align: center;'>Tuesday</td>\n                    <td style='text-align: center;'>Wednesday</td>\n                    <td style='text-align: center;'>Thursday</td>\n                    <td style='text-align: center;'>Friday</td>\n                    <td style='text-align: center;'>Saturday</td>\n                </tr>\n            </thead>\n            <tbody id='calendarBody'></tbody>");var r=_.h("#calendar");r.select("#currentMonth").data([a]).join("h2").text((function(t){return t}));var i=r.select("#calendarBody").selectAll("tbody").data(n).join("tr"),c=e.date_earlier.getDate(),o=e.date_later.getDate();i.selectAll("td").data((function(t){return t})).join("td").attr("class",(function(t){return t>0?"calendarDay":"calendarDayEmpty"})).attr("id",(function(t){return"calendarDay-"+t})).html((function(t){return t===c||t===o?"<div>".concat(t,"</div><svg id='").concat(t===c?"earlierAmount":"laterAmount","'></svg>"):t>0?t:""})),i.select("#earlierAmount").select("text").data([e.earlier_amount]).join("text").attr("text-anchor","middle").attr("class","earlier-amount").text((function(t){return t}))}),e),style:i})};var rt=function(){var t=Object(o.c)(Q);return Object(Y.jsx)(V.a,{fluid:!0,children:Object(Y.jsx)(Z.a,{children:Object(Y.jsx)(J.a,{children:t.view_type===D.barchart?Object(Y.jsx)(et,{top_margin:"20",right_margin:"30",bottom_margin:"30",left_margin:"80"}):t.view_type===D.word?Object(Y.jsx)(X,{}):Object(Y.jsx)(at,{top_margin:"20",right_margin:"20",bottom_margin:"30",left_margin:"30"})})})})},it=n(119),ct=n.n(it);function ot(){var t=Object(o.b)(),e=Object(o.c)(I),n=Object(W.g)().search,r=new URLSearchParams(n).get("participant_id"),i=new URLSearchParams(n).get("question_set_id");return t(z(r)),t(L(i)),Object(a.useEffect)((function(){e===w&&t(R(i))}),[e,t]),Object(Y.jsx)("div",{children:e===T&&Object(Y.jsx)(ct.a,{type:"spinningBubbles",color:"#444"})})}var st=n(120),ut=function(){var t=Object(o.c)(Q);return Object(Y.jsxs)("div",{className:"footer",children:["Version: ",st.a,Object(Y.jsx)("div",{className:"stickRight",children:t?t.comment:""})]})},lt=function(){return Object(Y.jsx)("div",{children:Object(Y.jsx)(M.a,{children:Object(Y.jsxs)("div",{className:"App",children:[Object(Y.jsxs)(K.a,{bg:"dark",variant:"dark",expand:"lg",children:[Object(Y.jsx)(K.a.Brand,{as:M.b,to:"/",children:"Viz Survey"}),Object(Y.jsx)(K.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(Y.jsx)(K.a.Collapse,{id:"basic-navbar-nav",children:Object(Y.jsx)(B.a,{className:"mr-auto",children:Object(Y.jsx)(B.a.Item,{href:"/survey",children:Object(Y.jsx)(B.a.Link,{as:M.b,to:"/survey",children:"Survey"})})})})]}),Object(Y.jsx)(ot,{}),Object(Y.jsxs)(W.d,{children:[Object(Y.jsx)(W.b,{exact:!0,path:"/",component:dt}),Object(Y.jsx)(W.b,{path:"/survey",component:rt}),Object(Y.jsx)(W.b,{path:"/thankyou",component:bt}),Object(Y.jsx)(W.b,{path:"/*",component:dt})]}),Object(Y.jsx)(ut,{className:"footer bg-dark"})]})})})},dt=function(){return Object(Y.jsxs)("div",{id:"home-text",children:[Object(Y.jsx)("p",{children:"*** TODO: Inert the survey instructions for the subject here ***"}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{href:" https://github.com/pcordone/vizsurvey",children:"Github README.md"})}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{id:"getQuestionSet",href:"http://localhost:3000/vizsurvey?participant_id=1&question_set_id=2",children:"localhost"})}),Object(Y.jsx)("p",{children:Object(Y.jsx)("a",{href:"https://pcordone.github.io/vizsurvey/?participant_id=1&question_set_id=2",children:"localhost"})})]})};var bt=function(){var t=Object(o.b)(),e=function(t){var e=t.map((function(t){return"".concat(t.question_set_id,", ").concat(t.position,", ").concat(t.amount_earlier,", ").concat(t.time_earlier,", ").concat(t.amount_later,", ").concat(t.time_later,", ").concat(t.choice,", ").concat(t.answer_time,", ").concat(t.participant_id)}));return["question_set_id,position,amount_earlier,time_earlier,amount_later,time_later,choice,answer_time,participant_id"].concat(e).join("\n")}(Object(o.c)(k));return console.log(e),t(C(e)),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("p",{children:"Your answers have been submitted. Thank you for taking this survey!"}),"."]})},jt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};c.a.render(Object(Y.jsx)(r.a.StrictMode,{children:Object(Y.jsx)(o.a,{store:H,children:Object(Y.jsx)(lt,{})})}),document.getElementById("root")),jt()}},[[247,1,2]]]);
//# sourceMappingURL=main.c0c9ef19.chunk.js.map