(this.webpackJsonpvizsurvey=this.webpackJsonpvizsurvey||[]).push([[0],{101:function(t,e,n){},102:function(t,e,n){},110:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),r=n(34),o=n.n(r),c=n(57),s=n(2),u=n(29),l=n(28),h=n.n(l),m=n(50),d=n(6),b=n(35),p=n(18),j=n(25),v=n(27),g=n(26),w=function(t){Object(j.a)(n,t);var e=Object(v.a)(n);function n(){return Object(d.a)(this,n),e.apply(this,arguments)}return n}(g.Enumify);w.word=new w,w.barchart=new w,w.calendar=new w,w._=w.closeEnum();var x=function(t){Object(j.a)(n,t);var e=Object(v.a)(n);function n(){return Object(d.a)(this,n),e.apply(this,arguments)}return n}(g.Enumify);x.none=new x,x.earlierAmount=new x,x.laterAmount=new x,x._=x.closeEnum();var f=function(t){Object(j.a)(n,t);var e=Object(v.a)(n);function n(){return Object(d.a)(this,n),e.apply(this,arguments)}return n}(g.Enumify);f.none=new f,f.drag=new f,f.titration=new f,f._=f.closeEnum();var y=function t(e){var n=e.treatmentId,i=e.position,a=e.viewType,r=e.interaction,o=e.variableAmount,c=e.amountEarlier,s=e.timeEarlier,u=e.dateEarlier,l=e.amountLater,h=e.timeLater,m=e.dateLater,b=e.maxAmount,p=e.maxTime,j=e.horizontalPixels,v=e.verticalPixels,g=e.leftMarginWidthIn,w=e.bottomMarginHeightIn,x=e.graphWidthIn,f=e.graphHeightIn,y=e.width,O=e.height,_=e.comment;Object(d.a)(this,t),this.treatmentId=n,this.position=i,this.viewType=a,this.interaction=r,this.variableAmount=o,this.amountEarlier=c,this.timeEarlier=s,this.dateEarlier=u,this.amountLater=l,this.timeLater=h,this.dateLater=m,this.maxAmount=b,this.maxTime=p,this.horizontalPixels=j,this.verticalPixels=v,this.leftMarginWidthIn=g,this.bottomMarginHeightIn=w,this.graphWidthIn=x,this.graphHeightIn=f,this.width=y,this.height=O,this.comment=_,this.highup=null,this.lowdown=null};var O=function(){function t(){Object(d.a)(this,t),this.fetchQuestions=function(t){return t=+t,Object(p.a)('treatment_id,position,view_type,interaction,variable_amount,amount_earlier,time_earlier,date_earlier,amount_later,time_later,date_later,max_amount,max_time,horizontal_pixels,vertical_pixels,left_margin_width_in,bottom_margin_height_in,graph_width_in,graph_height_in,width_in,height_in,comment\n1,1,word,none,none,500,2,,1000,3,,,10,,,,,,,,,"Read 2001 example, absolute size"\n2,1,barchart,none,none,500,2,,1000,3,,1000,10,100,100,0.5,0.5,6,6,6.5,6.5,"Read 2001 example, absolute size"\n3,1,barchart,drag,laterAmount,500,2,,1000,10,,1500,10,100,100,0.5,0.5,6,6,6.5,6.5,"Read 2001 example, absolute size"\n4,1,word,titration,laterAmount,500,2,,1000,3,,,10,,,,,,,,,"Read 2001 example, absolute size"\n5,1,barchart,titration,laterAmount,500,2,,1000,10,,1500,10,100,100,0.5,0.5,3,3,3.5,3.5,"Read 2001 example, absolute size"\n',(function(t){return new y({treatmentId:+(e=t).treatment_id,position:+e.position,viewType:w.enumValueOf(e.view_type),interaction:f.enumValueOf(e.interaction),variableAmount:x.enumValueOf(e.variable_amount),amountEarlier:+e.amount_earlier,timeEarlier:e.time_earlier?+e.time_earlier:void 0,dateEarlier:e.date_earlier?new Date(e.date_earlier):void 0,amountLater:+e.amount_later,timeLater:e.time_later?+e.time_later:void 0,dateLater:e.date_later?new Date(e.date_later):void 0,maxAmount:+e.max_amount,maxTime:+e.max_time,horizontalPixels:+e.horizontal_pixels,verticalPixels:+e.vertical_pixels,leftMarginWidthIn:+e.left_margin_width_in,bottomMarginHeightIn:+e.bottom_margin_height_in,graphWidthIn:+e.graph_width_in,graphHeightIn:+e.graph_height_in,width:+e.width,height:+e.height,comment:e.comment});var e})).filter((function(e){return e.treatmentId===t}))},this.writeAnswers=function(){var t=Object(m.a)(h.a.mark((function t(e,n){var i,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=n.getState,a=i(),console.log(e),console.log(JSON.stringify(a));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}return Object(b.a)(t,[{key:"convertToCSV",value:function(t){var e=t.map((function(t){return"".concat(t.treatmentId,", ").concat(t.position,", ").concat(t.viewType,", ").concat(t.interaction,", ").concat(t.amountEarlier,", ").concat(t.timeEarlier,", ").concat(t.dateEarlier,", ").concat(t.amountLater,", ").concat(t.timeLater,", ").concat(t.dateLater,", ").concat(t.maxAmount,", ").concat(t.maxTime,", ").concat(t.verticalPixels,", ").concat(t.horizontalPixels,", ").concat(t.leftMarginWidthIn,", ").concat(t.bottomMarginHeightIn,", ").concat(t.graphWidthIn,", ").concat(t.graphHeightIn,", ").concat(t.choice,", ").concat(t.shownTimestamp,", ").concat(t.choiceTimestamp,", ").concat(t.highup,", ").concat(t.lowdown,", ").concat(t.participantCode)}));return["treatment_id,position,view_type,interaction,amount_earlier,time_earlier,date_earlier,amount_later,time_later,date_later,max_amount,max_time,vertical_pixels,horizontal_pixels,left_margin_width_in,bottom_margin_height_in,graph_width_in,graph_height_in,choice,shown_timestamp,choice_timestamp,highup,lowdown,participant_code"].concat(e).join("\n")}}]),t}(),_="Unitialized",A="Fetched",I="Complete",T="unitialized",E="earlier",L="later",k=function t(e){var n=e.treatmentId,i=e.position,a=e.viewType,r=e.interaction,o=e.amountEarlier,c=e.timeEarlier,s=e.dateEarlier,u=e.amountLater,l=e.timeLater,h=e.dateLater,m=e.maxAmount,b=e.maxTime,p=e.verticalPixels,j=e.horizontalPixels,v=e.leftMarginWidthIn,g=e.bottomMarginHeightIn,w=e.graphWidthIn,x=e.graphHeightIn,f=e.choice,y=e.shownTimestamp,O=e.choiceTimestamp,_=e.highup,A=e.lowdown,I=e.participantCode;Object(d.a)(this,t),this.treatmentId=n,this.position=i,this.viewType=a,this.interaction=r,this.amountEarlier=o,this.timeEarlier=c,this.dateEarlier=s,this.amountLater=u,this.timeLater=l,this.dateLater=h,this.maxAmount=m,this.maxTime=b,this.verticalPixels=p,this.horizontalPixels=j,this.leftMarginWidthIn=v,this.bottomMarginHeightIn=g,this.graphWidthIn=w,this.graphHeightIn=x,this.choice=f,this.shownTimestamp=y,this.choiceTimestamp=O,this.highup=_,this.lowdown=A,this.participantCode=I},z=new(function(){function t(){Object(d.a)(this,t)}return Object(b.a)(t,[{key:"currentTreatment",value:function(t){return t.questions[t.currentQuestionIdx]}},{key:"currentTreatmentAndLatestAnswer",value:function(t){return{treatment:this.currentTreatment(t),latestAnswer:this.latestAnswer(t)}}},{key:"latestAnswer",value:function(t){return 0===t.answers.length?null:t.answers[t.answers.length-1]}},{key:"createNextAnswer",value:function(t,e,n,i,a,r){var o=new k({treatmentId:t.id,position:t.position,viewType:t.viewType,interaction:t.interaction,amountEarlier:n,timeEarlier:t.timeEarlier,dateEarlier:t.dateEarlier,amountLater:i,timeLater:t.timeLater,dateLater:t.dateLater,maxAmount:t.maxAmount,maxTime:t.maxTime,verticalPixels:t.verticalPixels,horizontalPixels:t.horizontalPixels,leftMarginWidthIn:t.leftMarginWidthIn,bottomMarginHeightIn:t.bottomMarginHeightIn,graphWidthIn:t.graphWidthIn,graphHeightIn:t.graphHeightIn,choice:T,highup:a,lowdown:r});e.push(o)}},{key:"allQuestions",value:function(t){return t.answers}},{key:"startSurvey",value:function(t){t.currentQuestionIdx=0;var e=this.currentTreatment(t);t.highup=e.variableAmount===x.laterAmount?e.amountEarlier:e.amountLater,t.lowdown=void 0,this.createNextAnswer(e,t.answers,e.amountEarlier,e.amountLater,t.highup,t.lowdown)}},{key:"setLatestAnswerShown",value:function(t,e){this.latestAnswer(t).shownTimestamp=e.payload}},{key:"isLastTreatment",value:function(t){return t.currentQuestionIdx===t.questions.length-1}},{key:"incNextQuestion",value:function(t){if(this.isLastTreatment(t))t.status=I;else{t.currentQuestionIdx+=1;var e=this.currentTreatment(t);this.createNextAnswer(e,t.answers,e.amountEarlier,e.amountLater)}}},{key:"updateHighupOrLowdown",value:function(t){var e=this.currentTreatmentAndLatestAnswer(t),n=e.treatment,i=e.latestAnswer;switch(i.choice){case E:var a=n.variableAmount===x.laterAmount?i.amountLater:i.amountEarlier;(!t.highup||a>t.highup)&&(t.highup=a);break;case L:var r=n.variableAmount===x.laterAmount?i.amountLater:i.amountEarlier;(!t.lowdown||r<t.lowdown)&&(t.lowdown=r);break;default:console.assert(!0,"Invalid value for current answer in setAnswerCurrentQuestion")}}},{key:"calcTitrationAmount",value:function(t,e,n){return(n||t-e)/2}},{key:"calcNewAmount",value:function(t,e){var n,i=this.currentTreatmentAndLatestAnswer(t),a=i.treatment,r=i.latestAnswer;switch(a.variableAmount){case x.laterAmount:return console.assert(r.choice&&r.choice!==T),n=r.choice===E?e:-1*e,10*parseInt((r.amountLater+n)/10);case x.earlierAmount:return n=r.choice===E?-1*e:e,10*parseInt((r.amountEarlier+n)/10);default:console.assert(!0,"Invalid value for question titration type in calcEarlierAndLaterAmounts")}}},{key:"answerCurrentQuestion",value:function(t,e){var n=this.currentTreatmentAndLatestAnswer(t),i=n.treatment,a=n.latestAnswer;if(a.choice=e.payload.choice,a.choiceTimestamp=e.payload.choiceTimestamp.toFormat("MM/dd/yyyy H:mm:ss:SSS ZZZZ"),i.interaction===f.none||i.interaction===f.drag)this.incNextQuestion(t);else if(i.interaction===f.titration){var r=this.calcTitrationAmount(i.variableAmount===x.laterAmount?a.amountLater:a.amountEarlier,t.highup,1===a.length?t.highup:null);if(this.updateHighupOrLowdown(t),t.lowdown-t.highup<=10)this.incNextQuestion(t);else{var o=this.calcNewAmount(t,r);i.variableAmount===x.laterAmount?this.createNextAnswer(i,t.answers,i.amountEarlier,o):i.variableAmount===x.earlierAmount?this.createNextAnswer(i,t.answers,o,i.amountLater):console.assert(!0,"Titration not set to amountEarlier or amountLater before calling answerCurrentQuestion")}}}}]),t}()),M=new O,S=Object(u.b)("survey/writeAnswers",M.writeAnswers),P=Object(u.c)({name:"questions",initialState:{treatmentId:null,participantId:null,questions:[],answers:[],currentQuestionIdx:0,highup:void 0,lowdown:void 0,status:_,error:null},reducers:{setParticipant:function(t,e){return t.participantId=e.payload,t},setTreatmentId:function(t,e){return t.treatmentId=e.payload,t},fetchQuestions:function(t){return t.questions=M.fetchQuestions(t.treatmentId),t.status=A,t},startSurvey:function(t){return z.startSurvey(t),t},setQuestionShownTimestamp:function(t,e){return z.setLatestAnswerShown(t,e),t},answer:function(t,e){z.answerCurrentQuestion(t,e)}}}),W=function(t){return z.allQuestions(t.questions)},q=function(t){return z.currentTreatment(t.questions)},H=function(t){return z.latestAnswer(t.questions)},C=function(t){return t.questions.status},Q=function(t){return t.questions.treatmentId},D=P.actions,N=D.fetchQuestions,R=D.startSurvey,F=D.setQuestionShownTimestamp,B=D.answer,J=D.setParticipant,V=D.setTreatmentId,Z=P.reducer,U=Object(u.a)({reducer:{questions:Z},middleware:function(t){return t()}}),Y=(n(101),n(23)),G=n(3),$=n(30),K=n(115),X=n(116),tt=(n(102),n(112)),et=n(113),nt=n(114),it=n(43),at=n(20),rt=n(1);var ot=function(){var t=Object(s.b)(),e=Object(s.c)(H),n=Object(s.c)(C);function i(){return"$".concat(e.amountEarlier," ").concat(0===(t=e.timeEarlier)?"today":"in ".concat(t," weeks"));var t}var a=Object(rt.jsx)(at.d,{initialValues:{choice:T},validate:function(t){var e={};return t.choice&&t.choice!==T||(e.choice="Please choose a selection to continue."),e},onSubmit:function(e,n){var i=n.setSubmitting,a=n.resetForm;setTimeout((function(){t(B({choice:e.choice,choiceTimestamp:it.DateTime.now()})),i(!1),a()}),400)},children:function(t){var n=t.isSubmitting;return Object(rt.jsxs)(at.c,{children:[Object(rt.jsxs)("div",{role:"group","aria-labelledby":"my-radio-group",className:"radio-choice-label",children:[Object(rt.jsxs)("label",{children:[Object(rt.jsx)(at.b,{type:"radio",name:"choice",value:E}),"\xa0",i()]}),Object(rt.jsx)("br",{}),Object(rt.jsxs)("label",{children:[Object(rt.jsx)(at.b,{type:"radio",name:"choice",value:L}),"\xa0","$".concat(e.amountLater," in ").concat(e.timeLater," weeks")]}),Object(rt.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:Object(rt.jsx)(at.a,{name:"choice",component:"div"})})]}),Object(rt.jsx)(X.a,{type:"submit",disabled:n,children:"Submit"})]})}});return n===I?Object(rt.jsx)(G.a,{to:"/thankyou"}):(t(F(Date.now())),a)},ct=function(t,e){var n=a.a.useRef();return a.a.useEffect((function(){return t(p.b(n.current)),function(){}}),e),n};var st=function(){var t=Object(s.b)(),e=Object(s.c)(H),n=Object(s.c)(C),i=window.devicePixelRatio>=2?132:96,a=e.leftMarginWidthIn+e.graphWidthIn,r=e.bottomMarginHeightIn+e.graphHeightIn,o=(Array.from(Array(e.maxTime+1).keys()).map((function(t){return t===e.timeEarlier?{time:t,amount:e.amountEarlier}:t===e.timeLater?{time:t,amount:e.amountLater}:{time:t,amount:0}})),Object(rt.jsx)("svg",{id:"test-svg",viewBox:"0 0 ".concat(a," ").concat(r),width:"".concat(a*i),height:"".concat(r*i),preserveAspectRatio:"xMinYMin meet",style:{flexGrow:0,minWidth:0},children:Object(rt.jsx)("rect",{x:"0.5",y:"0.5",width:"3",height:"3",style:{stroke:"black",fill:"none",strokeWidth:"0.05"}})}));return n===I?Object(rt.jsx)(G.a,{to:"/thankyou"}):(t(F(Date.now())),o)},ut=n(107);var lt=function(t){var e=Object(s.c)(H),n=e.question.verticalPixels,i=e.question.horizontalPixels,a={top:t.top_margin,right:t.right_margin,bottom:t.bottom_margin,left:t.left_margin},r={height:n+parseInt(a.top)+parseInt(a.bottom),width:i+parseInt(a.left)+parseInt(a.right),marginLeft:a.left+"px",marginRight:a.right+"px"};return Object(rt.jsx)("table",{id:"calendar",ref:ct((function(t){var n=ut(e.question.dateEarlier),i=["January","February","March","April","May","June","July","August","September","October","November","December"][e.question.dateEarlier.getMonth()];t.html("<thead>\n                <tr>\n                    <td span='7'>\n                        <h2 id='currentMonth'></h2>\n                    </td>\n                </tr>\n                <tr>\n                    <td style='text-align: center;'>Sunday</td>\n                    <td style='text-align: center;'>Monday</td>\n                    <td style='text-align: center;'>Tuesday</td>\n                    <td style='text-align: center;'>Wednesday</td>\n                    <td style='text-align: center;'>Thursday</td>\n                    <td style='text-align: center;'>Friday</td>\n                    <td style='text-align: center;'>Saturday</td>\n                </tr>\n            </thead>\n            <tbody id='calendarBody'></tbody>");var a=p.b("#calendar");a.select("#currentMonth").data([i]).join("h2").text((function(t){return t}));var r=a.select("#calendarBody").selectAll("tbody").data(n).join("tr"),o=e.question.dateEarlier.getDate(),c=e.question.dateLater.getDate();r.selectAll("td").data((function(t){return t})).join("td").attr("class",(function(t){return t>0?"calendarDay":"calendarDayEmpty"})).attr("id",(function(t){return"calendarDay-"+t})).html((function(t){return t===o||t===c?"<div>".concat(t,"</div><svg id='").concat(t===o?"earlierAmount":"laterAmount","'></svg>"):t>0?t:""})),r.select("#earlierAmount").select("text").data([e.question.amountEarlier]).join("text").attr("text-anchor","middle").attr("class","earlier-amount").text((function(t){return t}))}),e),style:r})};var ht=function(){var t=Object(s.c)(H);return Object(rt.jsx)(tt.a,{fluid:!0,children:Object(rt.jsx)(et.a,{children:Object(rt.jsx)(nt.a,{children:t.viewType===w.barchart?Object(rt.jsx)(st,{top_margin:"20",right_margin:"30",bottom_margin:"30",left_margin:"80"}):t.viewType===w.word?Object(rt.jsx)(ot,{}):Object(rt.jsx)(lt,{top_margin:"20",right_margin:"20",bottom_margin:"30",left_margin:"30"})})})})};function mt(){var t=Object(s.b)(),e=Object(G.g)().search,n=new URLSearchParams(e).get("treatment_id");return t(V(n)),""}var dt=function(){return Object(rt.jsx)("div",{children:Object(rt.jsx)(Y.a,{children:Object(rt.jsxs)("div",{className:"App",children:[Object(rt.jsx)(mt,{}),Object(rt.jsxs)(G.d,{children:[Object(rt.jsx)(G.b,{exact:!0,path:"/",component:bt}),Object(rt.jsx)(G.b,{exact:!0,path:"/instructions",component:pt}),Object(rt.jsx)(G.b,{path:"/survey",component:ht}),Object(rt.jsx)(G.b,{path:"/thankyou",component:jt}),Object(rt.jsx)(G.b,{path:"/*",component:bt})]})]})})})},bt=function(){var t=Object(s.c)(Q);return Object(rt.jsx)("div",{id:"home-text",children:null===t?Object(rt.jsxs)("div",{children:[Object(rt.jsx)("p",{children:"We shouldn not see this page since the participants will be provided a link with the treatment id in the URL."}),Object(rt.jsx)("p",{children:"Click a link below to launc one of the experiments."}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{href:"https://github.com/pcordone/vizsurvey",children:"Github README.md"})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{href:"https://pcordone.github.io",children:"public website"})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{id:"word-no-titration",href:"vizsurvey/instructions?treatment_id=1",children:"Worded with no titration and not draggable."})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{id:"barchart-no-titration",href:"vizsurvey/instructions?treatment_id=2",children:"Barchart with no titration and not draggable."})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{id:"barchart-drag",href:"vizsurvey/instructions?treatment_id=3",children:"Barchart draggable."})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{id:"word-titration",href:"vizsurvey/instructions?treatment_id=4",children:"Word titration."})}),Object(rt.jsx)("p",{children:Object(rt.jsx)("a",{id:"barchart-titration",href:"vizsurvey/instructions?treatment_id=5",children:"Barchart titration."})})]}):Object(rt.jsx)(G.a,{to:"/instructions?treatment_id=".concat(t)})})},pt=function(){var t=Object($.b)(),e=Object(s.b)();e(N());var n=Object(s.c)(q);return Object(rt.jsxs)("div",{id:"home-text",children:[n.viewType===w.barchart?Object(rt.jsx)("div",{children:"Click on the bar that represents the amount that you would like to receive."}):n.viewType===w.word?Object(rt.jsx)("div",{children:"Click on the radio button that contains the amount you would like to receive."}):n.viewType===w.calendar?Object(rt.jsx)("div",{children:"Click on the day that contains the amount that you would like to receive."}):Object(rt.jsxs)("div",{children:["Cannot display ",Object(rt.jsx)("b",{children:"specific"})," instructions since a treatment has not been selected. Please select a treatment"]}),Object(rt.jsx)($.a,{handle:t,children:Object(rt.jsx)(Y.b,{to:"/survey",children:Object(rt.jsx)(X.a,{size:"lg",onClick:function(){e(R()),t.enter},children:"Start Survey"})})})]})},jt=function(){var t=Object(s.b)(),e=Object(K.a)();t(J(e));var n=Object(s.c)(W),i=(new O).convertToCSV(n);t(S(i));var a=Object($.b)();return Object(rt.jsx)($.a,{handle:a,children:Object(rt.jsxs)("div",{children:[Object(rt.jsx)("p",{children:"Your answers have been submitted. Thank you for taking this survey!"}),Object(rt.jsxs)("p",{children:["Your unique ID is: ",e,". Please go back to Amazon Turk and present this unique ID in the form."]}),Object(rt.jsx)(X.a,{size:"lg",onClick:function(){a.enter(),setTimeout((function(){a.exit()}),400)},children:"Exit Fullscreen"})]})})},vt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,117)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,r=e.getLCP,o=e.getTTFB;n(t),i(t),a(t),r(t),o(t)}))};Object(c.a)(),o.a.render(Object(rt.jsx)(a.a.StrictMode,{children:Object(rt.jsx)(s.a,{store:U,children:Object(rt.jsx)(dt,{})})}),document.getElementById("root")),vt()}},[[110,1,2]]]);
//# sourceMappingURL=main.976a1d24.chunk.js.map